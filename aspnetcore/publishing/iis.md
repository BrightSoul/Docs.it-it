---
title: Host ASP.NET Core in Windows con IIS
author: guardrex
description: Configurazione di Windows Server Internet Information Services (IIS) e distribuzione di applicazioni di ASP.NET Core.
keywords: ASP.NET Core, servizi di informazioni internet, iis, server windows, aggregazione di hosting, modulo di asp.net core, distribuzione web
ms.author: riande
manager: wpickett
ms.date: 03/13/2017
ms.topic: article
ms.assetid: a4449ad3-5bad-410c-afa7-dc32d832b552
ms.technology: aspnet
ms.prod: asp.net-core
uid: publishing/iis
ms.openlocfilehash: 7eb1537df47fcf0b24db2a7d843b655a6f6f8f21
ms.sourcegitcommit: 8f42ab93402c1b8044815e1e48d0bb84c81f8b59
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 11/29/2017
---
# <a name="host-aspnet-core-on-windows-with-iis"></a><span data-ttu-id="485fa-104">Host ASP.NET Core in Windows con IIS</span><span class="sxs-lookup"><span data-stu-id="485fa-104">Host ASP.NET Core on Windows with IIS</span></span>

<span data-ttu-id="485fa-105">Di [Luke Latham](https://github.com/guardrex) e [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="485fa-105">By [Luke Latham](https://github.com/guardrex) and [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

## <a name="supported-operating-systems"></a><span data-ttu-id="485fa-106">Sistemi operativi supportati</span><span class="sxs-lookup"><span data-stu-id="485fa-106">Supported operating systems</span></span>

<span data-ttu-id="485fa-107">Sono supportati i sistemi operativi seguenti:</span><span class="sxs-lookup"><span data-stu-id="485fa-107">The following operating systems are supported:</span></span>

* <span data-ttu-id="485fa-108">Windows 7 e versioni più recenti</span><span class="sxs-lookup"><span data-stu-id="485fa-108">Windows 7 and newer</span></span>
* <span data-ttu-id="485fa-109">Windows Server 2008 R2 e più recenti &#8224;</span><span class="sxs-lookup"><span data-stu-id="485fa-109">Windows Server 2008 R2 and newer&#8224;</span></span>

<span data-ttu-id="485fa-110">&#8224; Concettualmente, la configurazione di IIS descritta in questo documento si applica anche per l'hosting delle applicazioni ASP.NET Core in Nano Server IIS, ma fare riferimento a [ASP.NET Core con IIS su Nano Server](xref:tutorials/nano-server) per istruzioni specifiche.</span><span class="sxs-lookup"><span data-stu-id="485fa-110">&#8224;Conceptually, the IIS configuration described in this document also applies to hosting ASP.NET Core applications on Nano Server IIS, but refer to [ASP.NET Core with IIS on Nano Server](xref:tutorials/nano-server) for specific instructions.</span></span>

<span data-ttu-id="485fa-111">Il [server HTTP.sys](xref:fundamentals/servers/httpsys) (chiamato in precedenza [WebListener](xref:fundamentals/servers/weblistener)) non funziona in una configurazione proxy inverso con IIS.</span><span class="sxs-lookup"><span data-stu-id="485fa-111">[HTTP.sys server](xref:fundamentals/servers/httpsys) (formerly called [WebListener](xref:fundamentals/servers/weblistener)) won't work in a reverse-proxy configuration with IIS.</span></span> <span data-ttu-id="485fa-112">È necessario usare il [server Kestrel](xref:fundamentals/servers/kestrel).</span><span class="sxs-lookup"><span data-stu-id="485fa-112">You must use the [Kestrel server](xref:fundamentals/servers/kestrel).</span></span>

## <a name="iis-configuration"></a><span data-ttu-id="485fa-113">Configurazione di IIS</span><span class="sxs-lookup"><span data-stu-id="485fa-113">IIS configuration</span></span>

<span data-ttu-id="485fa-114">Abilitare il ruolo **Server Web (IIS)** e stabilire i servizi di ruolo.</span><span class="sxs-lookup"><span data-stu-id="485fa-114">Enable the **Web Server (IIS)** role and establish role services.</span></span>

### <a name="windows-desktop-operating-systems"></a><span data-ttu-id="485fa-115">Sistemi operativi desktop di Windows</span><span class="sxs-lookup"><span data-stu-id="485fa-115">Windows desktop operating systems</span></span>

<span data-ttu-id="485fa-116">Passare a **Pannello di controllo** > **Programmi** > **Programmi e funzionalità** > **Attiva o disattiva funzionalità di Windows** (sul lato sinistro dello schermo).</span><span class="sxs-lookup"><span data-stu-id="485fa-116">Navigate to **Control Panel** > **Programs** > **Programs and Features** > **Turn Windows features on or off** (left side of the screen).</span></span> <span data-ttu-id="485fa-117">Aprire il gruppo per **Internet Information Services** e **Strumenti di gestione Web**.</span><span class="sxs-lookup"><span data-stu-id="485fa-117">Open the group for **Internet Information Services** and **Web Management Tools**.</span></span> <span data-ttu-id="485fa-118">Selezionare la casella per **Console di gestione IIS**.</span><span class="sxs-lookup"><span data-stu-id="485fa-118">Check the box for **IIS Management Console**.</span></span> <span data-ttu-id="485fa-119">Selezionare la casella per **Servizi World Wide Web**.</span><span class="sxs-lookup"><span data-stu-id="485fa-119">Check the box for **World Wide Web Services**.</span></span> <span data-ttu-id="485fa-120">Accettare le funzionalità predefinite per **servizi World Wide Web** o personalizzare le funzionalità IIS in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="485fa-120">Accept the default features for **World Wide Web Services** or customize the IIS features to suit your needs.</span></span>

![La console di gestione IIS e servizi World Wide Web sono selezionati nelle funzionalità di Windows.](iis/_static/windows-features-win10.png)

### <a name="windows-server-operating-systems"></a><span data-ttu-id="485fa-122">Sistemi operativi Windows Server</span><span class="sxs-lookup"><span data-stu-id="485fa-122">Windows Server operating systems</span></span>

<span data-ttu-id="485fa-123">Per i sistemi operativi del server, usare la procedura guidata **Aggiungi ruoli e funzionalità** tramite il menù **Gestisci** o il collegamento in **Server Manager**.</span><span class="sxs-lookup"><span data-stu-id="485fa-123">For server operating systems, use the **Add Roles and Features** wizard via the **Manage** menu or the link in **Server Manager**.</span></span> <span data-ttu-id="485fa-124">Nel passaggio **Ruoli del server** selezionare la casella per **Server Web (IIS)**.</span><span class="sxs-lookup"><span data-stu-id="485fa-124">On the **Server Roles** step, check the box for **Web Server (IIS)**.</span></span>

![Il ruolo Server Web IIS viene selezionato nel passaggio dei ruoli del server Selezionare.](iis/_static/server-roles-ws2016.png)

<span data-ttu-id="485fa-126">Nel passaggio **Servizi ruolo** selezionare i servizi ruolo IIS desiderato o accettare i servizi ruolo predefiniti forniti.</span><span class="sxs-lookup"><span data-stu-id="485fa-126">On the **Role services** step, select the IIS role services you desire or accept the default role services provided.</span></span>

![I servizi ruolo predefiniti vengono selezionati nel passaggio Selezionare i servizi ruolo.](iis/_static/role-services-ws2016.png)

<span data-ttu-id="485fa-128">Procedere con il passaggio **Conferma** per installare il ruolo del server web e i servizi.</span><span class="sxs-lookup"><span data-stu-id="485fa-128">Proceed through the **Confirmation** step to install the web server role and services.</span></span> <span data-ttu-id="485fa-129">Dopo l'installazione del ruolo Server Web (IIS) non è necessario riavviare il server o IIS.</span><span class="sxs-lookup"><span data-stu-id="485fa-129">A server/IIS restart isn't required after installing the Web Server (IIS) role.</span></span>

## <a name="install-the-net-core-windows-server-hosting-bundle"></a><span data-ttu-id="485fa-130">Installare l'aggregazione di Hosting di.NET Core Windows Server</span><span class="sxs-lookup"><span data-stu-id="485fa-130">Install the .NET Core Windows Server Hosting bundle</span></span>

1. <span data-ttu-id="485fa-131">Installare l'[aggregazione di Hosting di.NET Core Windows Server](https://aka.ms/dotnetcore-2-windowshosting) nel sistema di hosting.</span><span class="sxs-lookup"><span data-stu-id="485fa-131">Install the [.NET Core Windows Server Hosting bundle](https://aka.ms/dotnetcore-2-windowshosting) on the hosting system.</span></span> <span data-ttu-id="485fa-132">L'aggregazione installa il runtime di .NET Core, la libreria di .NET Core e il [modulo ASP.NET Core](xref:fundamentals/servers/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="485fa-132">The bundle installs the .NET Core Runtime, .NET Core Library, and the [ASP.NET Core Module](xref:fundamentals/servers/aspnet-core-module).</span></span> <span data-ttu-id="485fa-133">Il modulo crea il proxy inverso tra IIS e il server Kestrel.</span><span class="sxs-lookup"><span data-stu-id="485fa-133">The module creates the reverse-proxy between IIS and the Kestrel server.</span></span> <span data-ttu-id="485fa-134">Se nel sistema non è presente una connessione a Internet, ottenere e installare [Microsoft Visual C++ 2015 Redistributable](https://www.microsoft.com/download/details.aspx?id=53840) prima di installare l'aggregazione di Hosting di .NET Core Windows Server.</span><span class="sxs-lookup"><span data-stu-id="485fa-134">If the system doesn't have an Internet connection, obtain and install the [Microsoft Visual C++ 2015 Redistributable](https://www.microsoft.com/download/details.aspx?id=53840) before installing the .NET Core Windows Server Hosting bundle.</span></span>

2. <span data-ttu-id="485fa-135">Riavviare il sistema o eseguire **net stop was /y** seguito da **net start w3svc** da un prompt dei comandi per visualizzare una modifica al percorso di sistema.</span><span class="sxs-lookup"><span data-stu-id="485fa-135">Restart the system or execute **net stop was /y** followed by **net start w3svc** from a command prompt to pick up a change to the system PATH.</span></span>

> [!NOTE]
> <span data-ttu-id="485fa-136">Se si usa una configurazione condivisa di IIS, vedere [Modulo di ASP.NET Core con configurazione condivisa di IIS](xref:hosting/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration).</span><span class="sxs-lookup"><span data-stu-id="485fa-136">If you use an IIS Shared Configuration, see [ASP.NET Core Module with IIS Shared Configuration](xref:hosting/aspnet-core-module#aspnet-core-module-with-an-iis-shared-configuration).</span></span>

## <a name="install-web-deploy-when-publishing-with-visual-studio"></a><span data-ttu-id="485fa-137">Installare la Distribuzione Web quando si pubblica con Visual Studio</span><span class="sxs-lookup"><span data-stu-id="485fa-137">Install Web Deploy when publishing with Visual Studio</span></span>

<span data-ttu-id="485fa-138">Se si prevede di distribuire le applicazioni con [Distribuzione Web](/iis/publish/using-web-deploy/introduction-to-web-deploy) in [Visual Studio](https://www.visualstudio.com/vs/), installare la versione più recente di Distribuzione Web nel sistema host.</span><span class="sxs-lookup"><span data-stu-id="485fa-138">If you intend to deploy your applications with [Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) in [Visual Studio](https://www.visualstudio.com/vs/), install the latest version of Web Deploy on the hosting system.</span></span> <span data-ttu-id="485fa-139">Per installare Distribuzione Web, è possibile usare il [Programma di installazione dela piattaforma Web (WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) o ottenere direttamente da un programma di installazione di [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=43717).</span><span class="sxs-lookup"><span data-stu-id="485fa-139">To install Web Deploy, you can use the [Web Platform Installer (WebPI)](https://www.microsoft.com/web/downloads/platform.aspx) or obtain an installer directly from the [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=43717).</span></span> <span data-ttu-id="485fa-140">Il metodo preferito consiste nell'usare WebPI.</span><span class="sxs-lookup"><span data-stu-id="485fa-140">The preferred method is to use WebPI.</span></span> <span data-ttu-id="485fa-141">WebPI offre un'installazione autonoma e una configurazione per i provider di hosting.</span><span class="sxs-lookup"><span data-stu-id="485fa-141">WebPI offers a standalone setup and a configuration for hosting providers.</span></span>

## <a name="application-configuration"></a><span data-ttu-id="485fa-142">Configurazione dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="485fa-142">Application configuration</span></span>

### <a name="enabling-the-iisintegration-components"></a><span data-ttu-id="485fa-143">Abilitare i componenti IISIntegration</span><span class="sxs-lookup"><span data-stu-id="485fa-143">Enabling the IISIntegration components</span></span>

# <a name="aspnet-core-2xtabaspnetcore2x"></a>[<span data-ttu-id="485fa-144">ASP.NET Core 2.x</span><span class="sxs-lookup"><span data-stu-id="485fa-144">ASP.NET Core 2.x</span></span>](#tab/aspnetcore2x)

<span data-ttu-id="485fa-145">Un file *Program.cs* tipico chiama [CreateDefaultBuilder](/dotnet/api/microsoft.aspnetcore.webhost.createdefaultbuilder) per avviare la configurazione di un host.</span><span class="sxs-lookup"><span data-stu-id="485fa-145">A typical *Program.cs* calls [CreateDefaultBuilder](/dotnet/api/microsoft.aspnetcore.webhost.createdefaultbuilder) to begin setting up a host.</span></span> <span data-ttu-id="485fa-146">`CreateDefaultBuilder` configura [Kestrel](xref:fundamentals/servers/kestrel) come server Web e abilita l'integrazione IIS configurando il percorso base e la porta per il [modulo ASP.NET Core](xref:fundamentals/servers/aspnet-core-module):</span><span class="sxs-lookup"><span data-stu-id="485fa-146">`CreateDefaultBuilder` configures [Kestrel](xref:fundamentals/servers/kestrel) as the web server and enables IIS integration by configuring the base path and port for the [ASP.NET Core Module](xref:fundamentals/servers/aspnet-core-module):</span></span>

```csharp
public static IWebHost BuildWebHost(string[] args) =>
    WebHost.CreateDefaultBuilder(args)
        ...
```

# <a name="aspnet-core-1xtabaspnetcore1x"></a>[<span data-ttu-id="485fa-147">ASP.NET Core 1.x</span><span class="sxs-lookup"><span data-stu-id="485fa-147">ASP.NET Core 1.x</span></span>](#tab/aspnetcore1x)

<span data-ttu-id="485fa-148">Includere una dipendenza dal pacchetto [Microsoft.AspNetCore.Server.IISIntegration](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.IISIntegration/) nelle dipendenze dell'app.</span><span class="sxs-lookup"><span data-stu-id="485fa-148">Include a dependency on the [Microsoft.AspNetCore.Server.IISIntegration](https://www.nuget.org/packages/Microsoft.AspNetCore.Server.IISIntegration/) package in your app dependencies.</span></span> <span data-ttu-id="485fa-149">Incorporare il middleware di integrazione IIS nell'app aggiungendo il metodo di estensione *UseIISIntegration* a *WebHostBuilder*:</span><span class="sxs-lookup"><span data-stu-id="485fa-149">Incorporate IIS Integration middleware into the app by adding the *UseIISIntegration* extension method to *WebHostBuilder*:</span></span>

```csharp
var host = new WebHostBuilder()
    .UseKestrel()
    .UseIISIntegration()
    ...
```

<span data-ttu-id="485fa-150">Sono necessari sia `UseKestrel` sia `UseIISIntegration`.</span><span class="sxs-lookup"><span data-stu-id="485fa-150">Both `UseKestrel` and `UseIISIntegration` are required.</span></span> <span data-ttu-id="485fa-151">La chiamata del codice *UseIISIntegration* non influisce sulla portabilità del codice.</span><span class="sxs-lookup"><span data-stu-id="485fa-151">Code calling *UseIISIntegration* doesn't affect code portability.</span></span> <span data-ttu-id="485fa-152">Se l'app non viene eseguita dietro IIS (ad esempio, se l'app viene eseguita direttamente in Kestrel), `UseIISIntegration` non esegue nessuna operazione.</span><span class="sxs-lookup"><span data-stu-id="485fa-152">If the app isn't run behind IIS (for example, the app is run directly on Kestrel), `UseIISIntegration` no-ops.</span></span>

---

<span data-ttu-id="485fa-153">Per altre informazioni sull'hosting, vedere [Hosting in ASP.NET Core](xref:fundamentals/hosting).</span><span class="sxs-lookup"><span data-stu-id="485fa-153">For more information on hosting, see [Hosting in ASP.NET Core](xref:fundamentals/hosting).</span></span>

### <a name="iis-options"></a><span data-ttu-id="485fa-154">Opzioni IIS</span><span class="sxs-lookup"><span data-stu-id="485fa-154">IIS options</span></span>

<span data-ttu-id="485fa-155">Per configurare le opzioni del servizio *IISIntegration*, includere una configurazione del servizio per *IISOptions* in *ConfigureServices*:</span><span class="sxs-lookup"><span data-stu-id="485fa-155">To configure *IISIntegration* service options, include a service configuration for *IISOptions* in *ConfigureServices*:</span></span>

```csharp
services.Configure<IISOptions>(options => 
{
    ...
});
```

| <span data-ttu-id="485fa-156">Opzione</span><span class="sxs-lookup"><span data-stu-id="485fa-156">Option</span></span>                         | <span data-ttu-id="485fa-157">Impostazione predefinita</span><span class="sxs-lookup"><span data-stu-id="485fa-157">Default</span></span> | <span data-ttu-id="485fa-158">Impostazione</span><span class="sxs-lookup"><span data-stu-id="485fa-158">Setting</span></span> |
| ------------------------------ | ------- | ------- |
| `AutomaticAuthentication`      | `true`  | <span data-ttu-id="485fa-159">Se è `true`, il middleware di autenticazione imposta `HttpContext.User` e risponde alle richieste generiche.</span><span class="sxs-lookup"><span data-stu-id="485fa-159">If `true`, the authentication middleware sets the `HttpContext.User` and responds to generic challenges.</span></span> <span data-ttu-id="485fa-160">Se è `false`, il middleware di autenticazione fornisce solo un'identità (`HttpContext.User`) e risponde alle richieste solo in base a un’istruzione esplicita di `AuthenticationScheme`.</span><span class="sxs-lookup"><span data-stu-id="485fa-160">If `false`, the authentication middleware only provides an identity (`HttpContext.User`) and responds to challenges when explicitly requested by the `AuthenticationScheme`.</span></span> <span data-ttu-id="485fa-161">Per il funzionamento di `AutomaticAuthentication` l’autenticazione di Windows deve essere abilitata in IIS.</span><span class="sxs-lookup"><span data-stu-id="485fa-161">Windows Authentication must be enabled in IIS for `AutomaticAuthentication` to function.</span></span> |
| `AuthenticationDisplayName`    | `null`  | <span data-ttu-id="485fa-162">Imposta il nome visualizzato dagli utenti nelle pagine di accesso.</span><span class="sxs-lookup"><span data-stu-id="485fa-162">Sets the display name shown to users on login pages.</span></span> |
| `ForwardClientCertificate`     | `true`  | <span data-ttu-id="485fa-163">Se è `true` ed è presente l’intestazione della richiesta `MS-ASPNETCORE-CLIENTCERT`, `HttpContext.Connection.ClientCertificate` viene popolato.</span><span class="sxs-lookup"><span data-stu-id="485fa-163">If `true` and the `MS-ASPNETCORE-CLIENTCERT` request header is present, the `HttpContext.Connection.ClientCertificate` is populated.</span></span> |

### <a name="webconfig"></a><span data-ttu-id="485fa-164">web.config</span><span class="sxs-lookup"><span data-stu-id="485fa-164">web.config</span></span>

<span data-ttu-id="485fa-165">Il file *web.config* configura principalmente il modulo di ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="485fa-165">The *web.config* file primarily configures the ASP.NET Core Module.</span></span> <span data-ttu-id="485fa-166">e può fornire facoltativamente altre impostazioni di configurazione di IIS.</span><span class="sxs-lookup"><span data-stu-id="485fa-166">It may optionally provide additional IIS configuration settings.</span></span> <span data-ttu-id="485fa-167">La creazione, la trasformazione e la pubblicazione di *web.config* vengono gestite da .NET Core Web SDK (`Microsoft.NET.Sdk.Web`),</span><span class="sxs-lookup"><span data-stu-id="485fa-167">Creating, transforming, and publishing *web.config* is handled by the .NET Core Web SDK (`Microsoft.NET.Sdk.Web`).</span></span> <span data-ttu-id="485fa-168">che viene incluso all'inizio del file di progetto con estensione *csproj*, `<Project Sdk="Microsoft.NET.Sdk.Web">`.</span><span class="sxs-lookup"><span data-stu-id="485fa-168">The SDK is set  at the top of the project file (*.csproj*), `<Project Sdk="Microsoft.NET.Sdk.Web">`.</span></span> <span data-ttu-id="485fa-169">Per impedire che l'SDK trasformi il file *web.config*, aggiungere la proprietà **\<IsTransformWebConfigDisabled >** al file di progetto con un'impostazione di `true`:</span><span class="sxs-lookup"><span data-stu-id="485fa-169">To prevent the SDK from transforming the *web.config* file, add the **\<IsTransformWebConfigDisabled>** property to the project file with a setting of `true`:</span></span>

```xml
<PropertyGroup>
  <IsTransformWebConfigDisabled>true</IsTransformWebConfigDisabled>
</PropertyGroup>
```

<span data-ttu-id="485fa-170">Se non è presente un file *web.config* nel progetto quando si pubblica con *dotnet.publish* o con la pubblicazione di Visual Studio, il file viene creato automaticamente nell'[output pubblicato](xref:hosting/directory-structure).</span><span class="sxs-lookup"><span data-stu-id="485fa-170">If you don't have a *web.config* file in the project when you publish with *dotnet publish* or with Visual Studio publish, the file is created for you in [published output](xref:hosting/directory-structure).</span></span> <span data-ttu-id="485fa-171">Se nel progetto è presente un file *web.config*, il file viene trasformato con *processPath* e con gli *argomenti* corretti per la configurazione del [modulo di ASP.NET Core](xref:fundamentals/servers/aspnet-core-module), quindi viene spostato nell'output pubblicato.</span><span class="sxs-lookup"><span data-stu-id="485fa-171">If you have a *web.config* file in your project, it's transformed with the correct *processPath* and *arguments* to configure the [ASP.NET Core Module](xref:fundamentals/servers/aspnet-core-module) and moved to published output.</span></span> <span data-ttu-id="485fa-172">La trasformazione non tocca le impostazioni di configurazione di IIS incluse nel file.</span><span class="sxs-lookup"><span data-stu-id="485fa-172">The transformation doesn't touch IIS configuration settings that you've included in the file.</span></span>

## <a name="create-the-iis-website"></a><span data-ttu-id="485fa-173">Creare il sito Web IIS</span><span class="sxs-lookup"><span data-stu-id="485fa-173">Create the IIS Website</span></span>

1. <span data-ttu-id="485fa-174">Nel sistema IIS di destinazione creare una cartella per contenere le cartelle e i file pubblicati dell'app, descritti in [Struttura della directory](xref:hosting/directory-structure).</span><span class="sxs-lookup"><span data-stu-id="485fa-174">On the target IIS system, create a folder to contain the app's published folders and files, which are described in [Directory Structure](xref:hosting/directory-structure).</span></span>

2. <span data-ttu-id="485fa-175">All'interno della cartella creare una cartella *registri* per contenere i registri stdout (se si prevede di abilitare la registrazione per risolvere i problemi di avvio).</span><span class="sxs-lookup"><span data-stu-id="485fa-175">Within the folder you created, create a *logs* folder to hold stdout logs (if you plan to enable logging to troubleshoot start-up issues).</span></span> <span data-ttu-id="485fa-176">Se si prevede di distribuire l'applicazione con una cartella *registri* nel payload, è possibile saltare questo passaggio.</span><span class="sxs-lookup"><span data-stu-id="485fa-176">If you plan to deploy your application with a *logs* folder in the payload, you may skip this step.</span></span> <span data-ttu-id="485fa-177">È presente un [problema aperto relativo alla creazione automatica della cartella](https://github.com/aspnet/AspNetCoreModule/issues/30).</span><span class="sxs-lookup"><span data-stu-id="485fa-177">There's an [open issue to create the folder automatically](https://github.com/aspnet/AspNetCoreModule/issues/30).</span></span> <span data-ttu-id="485fa-178">Se si vuole che MSBuild crei la cartella *registri*, aggiungere il seguente `Target` al file di progetto:</span><span class="sxs-lookup"><span data-stu-id="485fa-178">If you would like MSBuild to create the *log* folder for you, add the following `Target` to your project file:</span></span>

   ```xml
   <Target Name="CreateLogsFolder" AfterTargets="AfterPublish">
     <MakeDir Directories="$(PublishDir)logs" Condition="!Exists('$(PublishDir)logs')" />
     <MakeDir Directories="$(PublishUrl)logs" Condition="!Exists('$(PublishUrl)logs')" />
   </Target>
   ```

3. <span data-ttu-id="485fa-179">In **Gestione IIS**, creare un nuovo sito Web.</span><span class="sxs-lookup"><span data-stu-id="485fa-179">In **IIS Manager**, create a new website.</span></span> <span data-ttu-id="485fa-180">Specificare un **Nome del sito** e impostare il **Percorso fisico** per la cartella di distribuzione dell'app che è stata creata.</span><span class="sxs-lookup"><span data-stu-id="485fa-180">Provide a **Site name** and set the **Physical path** to the app's deployment folder that you created.</span></span> <span data-ttu-id="485fa-181">Fornire la configurazione dell'**Associazione** e creare il sito Web.</span><span class="sxs-lookup"><span data-stu-id="485fa-181">Provide the **Binding** configuration and create the website.</span></span>

4. <span data-ttu-id="485fa-182">Impostare il pool di applicazioni su **Nessun codice gestito**.</span><span class="sxs-lookup"><span data-stu-id="485fa-182">Set the application pool to **No Managed Code**.</span></span> <span data-ttu-id="485fa-183">ASP.NET Core viene eseguito in un processo separato e gestisce il runtime.</span><span class="sxs-lookup"><span data-stu-id="485fa-183">ASP.NET Core runs in a separate process and manages the runtime.</span></span>

5. <span data-ttu-id="485fa-184">Aprire la finestra **Aggiungi sito Web**.</span><span class="sxs-lookup"><span data-stu-id="485fa-184">Open the **Add Website** window.</span></span>

   ![Fare clic su Aggiungi sito Web dal menu di scelta rapida dei siti.](iis/_static/add-website-context-menu-ws2016.png)

6. <span data-ttu-id="485fa-186">Configurare il sito Web.</span><span class="sxs-lookup"><span data-stu-id="485fa-186">Configure the website.</span></span>

   ![Specificare il nome del sito, il percorso fisico e il nome Host nel passaggio Aggiungi sito Web.](iis/_static/add-website-ws2016.png)

7. <span data-ttu-id="485fa-188">Nel riquadro **Pool di applicazioni** aprire la finestra **Modifica Pool di applicazioni** facendo clic con il pulsante destro del mouse sul pool di app del sito Web e selezionando **Impostazioni Basic** dal menu a comparsa.</span><span class="sxs-lookup"><span data-stu-id="485fa-188">In the **Application Pools** panel, open the **Edit Application Pool** window by right-clicking on the website's app pool and selecting **Basic Settings...** from the popup menu.</span></span>

   ![Selezionare le Impostazioni Basic dal menu di scelta rapida del Pool di applicazioni.](iis/_static/apppools-basic-settings-ws2016.png)

8. <span data-ttu-id="485fa-190">Impostare la **versione CLR.NET** su **Nessun codice gestito**.</span><span class="sxs-lookup"><span data-stu-id="485fa-190">Set the **.NET CLR version** to **No Managed Code**.</span></span>

   ![Non impostare il Codice gestito per la versione CLR.NET.](iis/_static/edit-apppool-ws2016.png)
     
    <span data-ttu-id="485fa-192">Nota: l'impostazione della **versione CLR.NET** su **Nessun codice gestito** è facoltativa.</span><span class="sxs-lookup"><span data-stu-id="485fa-192">Note: Setting the **.NET CLR version** to **No Managed Code** is optional.</span></span> <span data-ttu-id="485fa-193">ASP.NET Core non si basa sul caricamento del CLR del desktop.</span><span class="sxs-lookup"><span data-stu-id="485fa-193">ASP.NET Core doesn't rely on loading the desktop CLR.</span></span>

9. <span data-ttu-id="485fa-194">Confermare che l'identità del modello del processo disponga delle autorizzazioni appropriate.</span><span class="sxs-lookup"><span data-stu-id="485fa-194">Confirm the process model identity has the proper permissions.</span></span>

   <span data-ttu-id="485fa-195">Se si modifica l'identità predefinita del pool di app (**Modello di processo** > **Identità**) da **ApplicationPoolIdentity** a un'altra identità, verificare che la nuova identità disponga delle autorizzazioni necessarie per accedere alla cartella dell'app, al database e alle altre risorse richieste.</span><span class="sxs-lookup"><span data-stu-id="485fa-195">If you change the default identity of the app pool (**Process Model** > **Identity**) from **ApplicationPoolIdentity** to another identity, verify that the new identity has the required permissions to access the app's folder, database, and other required resources.</span></span>
   
## <a name="deploy-the-application"></a><span data-ttu-id="485fa-196">Distribuire l'applicazione</span><span class="sxs-lookup"><span data-stu-id="485fa-196">Deploy the application</span></span>
<span data-ttu-id="485fa-197">Distribuire l'applicazione nella cartella creata nel sistema IIS di destinazione.</span><span class="sxs-lookup"><span data-stu-id="485fa-197">Deploy the application to the folder you created on the target IIS system.</span></span> <span data-ttu-id="485fa-198">Il metodo consigliato per la distribuzione è [Distribuzione Web](/iis/publish/using-web-deploy/introduction-to-web-deploy).</span><span class="sxs-lookup"><span data-stu-id="485fa-198">[Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) is the recommended mechanism for deployment.</span></span> <span data-ttu-id="485fa-199">Le alternative a Distribuzione Web sono elencate di seguito.</span><span class="sxs-lookup"><span data-stu-id="485fa-199">Alternatives to Web Deploy are listed below.</span></span>

<span data-ttu-id="485fa-200">Verificare che l'app pubblicata per la distribuzione non sia in esecuzione.</span><span class="sxs-lookup"><span data-stu-id="485fa-200">Confirm that the published app for deployment isn't running.</span></span> <span data-ttu-id="485fa-201">I file nella cartella *publish* sono bloccati durante l'esecuzione dell'app.</span><span class="sxs-lookup"><span data-stu-id="485fa-201">Files in the *publish* folder are locked when the app is running.</span></span> <span data-ttu-id="485fa-202">La distribuzione non viene eseguita perché non è possibile copiare i file bloccati.</span><span class="sxs-lookup"><span data-stu-id="485fa-202">Deployment can't occur because locked files can't be copied.</span></span>

### <a name="web-deploy-with-visual-studio"></a><span data-ttu-id="485fa-203">Distribuzione web con Visual Studio</span><span class="sxs-lookup"><span data-stu-id="485fa-203">Web Deploy with Visual Studio</span></span>
<span data-ttu-id="485fa-204">Vedere l'argomento [Creare profili di pubblicazione per Visual Studio e MSBuild, per distribuire le app ASP.NET Core](xref:publishing/web-publishing-vs#publish-profiles) per informazioni su come creare un profilo di pubblicazione da usare con Distribuzione Web.</span><span class="sxs-lookup"><span data-stu-id="485fa-204">See [Create publish profiles for Visual Studio and MSBuild, to deploy ASP.NET Core apps](xref:publishing/web-publishing-vs#publish-profiles) topic to learn how to create a publish profile for use with Web Deploy.</span></span> <span data-ttu-id="485fa-205">Se il provider di hosting fornisce un Profilo di pubblicazione o il supporto per crearne uno, scaricare il profilo e importarlo usando la finestra di dialogo di Visual Studio **Pubblica**.</span><span class="sxs-lookup"><span data-stu-id="485fa-205">If your hosting provider supplies a Publish Profile or support for creating one, download their profile and import it using the Visual Studio **Publish** dialog.</span></span>

![Pagina della finestra di dialogo Pubblica](iis/_static/pub-dialog.png)

### <a name="web-deploy-outside-of-visual-studio"></a><span data-ttu-id="485fa-207">Distribuzione Web all'esterno di Visual Studio</span><span class="sxs-lookup"><span data-stu-id="485fa-207">Web Deploy outside of Visual Studio</span></span>
<span data-ttu-id="485fa-208">È anche possibile usare [Distribuzione Web](/iis/publish/using-web-deploy/introduction-to-web-deploy) all'esterno di Visual Studio dalla riga di comando.</span><span class="sxs-lookup"><span data-stu-id="485fa-208">You can also use [Web Deploy](/iis/publish/using-web-deploy/introduction-to-web-deploy) outside of Visual Studio from the command line.</span></span> <span data-ttu-id="485fa-209">Per altre informazioni sulla distribuzione, vedere [Strumento Distribuzione Web](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span><span class="sxs-lookup"><span data-stu-id="485fa-209">For more information, see [Web Deployment Tool](/iis/publish/using-web-deploy/use-the-web-deployment-tool).</span></span>

### <a name="alternatives-to-web-deploy"></a><span data-ttu-id="485fa-210">Alternative a Distribuzione web</span><span class="sxs-lookup"><span data-stu-id="485fa-210">Alternatives to Web Deploy</span></span>
<span data-ttu-id="485fa-211">Se non si desidera usare Distribuzione Web o non si usa Visual Studio, è possibile usare uno dei diversi metodi per spostare l'applicazione nel sistema di hosting, ad esempio Xcopy, Robocopy o PowerShell.</span><span class="sxs-lookup"><span data-stu-id="485fa-211">If you don't wish to use Web Deploy or are not using Visual Studio, you may use any of several methods to move the application to the hosting system, such as Xcopy, Robocopy, or PowerShell.</span></span> <span data-ttu-id="485fa-212">Gli utenti di Visual Studio possono usare gli [Esempi di pubblicazione](https://github.com/aspnet/vsweb-publish/blob/master/samples/samples.md).</span><span class="sxs-lookup"><span data-stu-id="485fa-212">Visual Studio users may use the [Publish Samples](https://github.com/aspnet/vsweb-publish/blob/master/samples/samples.md).</span></span>

## <a name="browse-the-website"></a><span data-ttu-id="485fa-213">Esplorare il sito Web</span><span class="sxs-lookup"><span data-stu-id="485fa-213">Browse the website</span></span>
![Il browser Microsoft Edge ha caricato la pagina di avvio IIS.](iis/_static/browsewebsite.png)
   
> [!WARNING]
> <span data-ttu-id="485fa-215">Le app .NET core sono ospitate tramite un proxy inverso tra IIS e il server Kestrel.</span><span class="sxs-lookup"><span data-stu-id="485fa-215">.NET Core apps are hosted via a reverse-proxy between IIS and the Kestrel server.</span></span> <span data-ttu-id="485fa-216">Per creare il proxy inverso, il file *web.config* deve essere presente nel percorso radice del contenuto (in genere il percorso di base dell'app) dell'applicazione distribuita, che è il percorso fisico del sito Web fornito a IIS.</span><span class="sxs-lookup"><span data-stu-id="485fa-216">In order to create the reverse-proxy, the *web.config* file must be present at the content root path (typically the app base path) of the deployed application, which is the website physical path provided to IIS.</span></span> <span data-ttu-id="485fa-217">I file riservati esistono nel percorso fisico dell'app, incluse le sottocartelle, ad esempio *my_application.runtimeconfig.json*, *my_application.xml* (commenti della documentazione XML), e *my_application.deps.json*.</span><span class="sxs-lookup"><span data-stu-id="485fa-217">Sensitive files exist on the app's physical path, including subfolders, such as *my_application.runtimeconfig.json*, *my_application.xml* (XML Documentation comments), and *my_application.deps.json*.</span></span> <span data-ttu-id="485fa-218">Il file *web.config* è necessario per creare il proxy inverso in Kestrel, che impedisce a IIS di usare questi e altri file riservati.</span><span class="sxs-lookup"><span data-stu-id="485fa-218">The *web.config* file is required to create the reverse proxy to Kestrel, which prevents IIS from serving these and other sensitive files.</span></span> <span data-ttu-id="485fa-219">**Di conseguenza è importante che il file *web.config* non sia inavvertitamente rinominato o rimosso dalla distribuzione.**</span><span class="sxs-lookup"><span data-stu-id="485fa-219">**Therefore, it's important that the *web.config* file isn't accidently renamed or removed from the deployment.**</span></span>

## <a name="data-protection"></a><span data-ttu-id="485fa-220">Protezione dei dati</span><span class="sxs-lookup"><span data-stu-id="485fa-220">Data protection</span></span>

<span data-ttu-id="485fa-221">Un'applicazione ASP.NET Core archivia il gruppo di chiavi in memoria alle condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="485fa-221">An ASP.NET Core application stores the keyring in memory under the following conditions:</span></span>

* <span data-ttu-id="485fa-222">Un sito Web è ospitato dietro a IIS.</span><span class="sxs-lookup"><span data-stu-id="485fa-222">A website is hosted behind IIS.</span></span>
* <span data-ttu-id="485fa-223">Lo stack di protezione dei dati non è stato configurato per archiviare il gruppo di chiavi in un archivio permanente.</span><span class="sxs-lookup"><span data-stu-id="485fa-223">The Data Protection stack hasn't been configured to store the keyring in a persistent store.</span></span>

<span data-ttu-id="485fa-224">Se il gruppo di chiavi viene archiviato in memoria, quando l'app viene riavviata:</span><span class="sxs-lookup"><span data-stu-id="485fa-224">If the keyring is stored in memory when the app restarts:</span></span>

* <span data-ttu-id="485fa-225">Tutti i token di autenticazione dei moduli non sono più validi.</span><span class="sxs-lookup"><span data-stu-id="485fa-225">All forms authentication tokens are invalidated.</span></span> 
* <span data-ttu-id="485fa-226">Gli utenti devono ripetere l'accesso alla richiesta successiva.</span><span class="sxs-lookup"><span data-stu-id="485fa-226">Users are required to login again on their next request.</span></span> 
* <span data-ttu-id="485fa-227">Tutti i dati protetti con il gruppo di chiavi non sono più protetti.</span><span class="sxs-lookup"><span data-stu-id="485fa-227">Any data you protected with the keyring are no longer protected.</span></span>

> [!WARNING]
> <span data-ttu-id="485fa-228">La protezione dei dati viene usata da diversi middlewares di ASP.NET, inclusi quelli usati nell'autenticazione.</span><span class="sxs-lookup"><span data-stu-id="485fa-228">Data Protection is used by several ASP.NET middlewares, including those used in authentication.</span></span> <span data-ttu-id="485fa-229">Anche se non si chiamano le API di protezione dei dati dal proprio codice è necessario configurare la protezione dei dati con uno script di distribuzione o nel proprio codice.</span><span class="sxs-lookup"><span data-stu-id="485fa-229">Even if you don't call Data Protection APIs from your own code, you should configure Data Protection with a deployment script or in your code.</span></span> <span data-ttu-id="485fa-230">Se non si configura la protezione dei dati, per impostazione predefinita le chiavi vengono mantenute in memoria ed eliminate quando l'app viene riavviata.</span><span class="sxs-lookup"><span data-stu-id="485fa-230">If you don't configure data protection, by default the keys are held in memory and discarded when your app restarts.</span></span> <span data-ttu-id="485fa-231">Il riavvio invalida i cookie scritti dal middleware di autenticazione dei cookie e gli utenti devono ripetere l'accesso.</span><span class="sxs-lookup"><span data-stu-id="485fa-231">Restarting invalidates cookies written by the cookie authentication middleware and users must login again.</span></span>

<span data-ttu-id="485fa-232">Per configurare la protezione dei dati in IIS è necessario usare uno degli approcci seguenti:</span><span class="sxs-lookup"><span data-stu-id="485fa-232">To configure Data Protection under IIS, you must use one of the following approaches:</span></span>

* <span data-ttu-id="485fa-233">Eseguire uno [script di powershell](https://github.com/aspnet/DataProtection/blob/dev/Provision-AutoGenKeys.ps1) per creare le voci del Registro di sistema appropriate (ad esempio `.\Provision-AutoGenKeys.ps1 DefaultAppPool`).</span><span class="sxs-lookup"><span data-stu-id="485fa-233">Run a [powershell script](https://github.com/aspnet/DataProtection/blob/dev/Provision-AutoGenKeys.ps1) to create suitable registry entries (For example, `.\Provision-AutoGenKeys.ps1 DefaultAppPool`).</span></span> <span data-ttu-id="485fa-234">Questa operazione archivia le chiavi nel Registro, protetto tramite DPAPI con una chiave a livello computer.</span><span class="sxs-lookup"><span data-stu-id="485fa-234">This stores keys in the registry, protected using DPAPI with a machine-wide key.</span></span>
* <span data-ttu-id="485fa-235">Configurare il Pool di applicazioni IIS per caricare il profilo utente.</span><span class="sxs-lookup"><span data-stu-id="485fa-235">Configure the IIS Application Pool to load the user profile.</span></span> <span data-ttu-id="485fa-236">Questa impostazione è nella sezione **Modello del processo** in **Impostazioni avanzate** per il pool di applicazioni.</span><span class="sxs-lookup"><span data-stu-id="485fa-236">This setting is in the **Process Model** section under the **Advanced Settings** for the application pool.</span></span> <span data-ttu-id="485fa-237">Impostare **Caricamento del profilo utente** su `True`.</span><span class="sxs-lookup"><span data-stu-id="485fa-237">Set **Load User Profile** to `True`.</span></span> <span data-ttu-id="485fa-238">Questa operazione archivia le chiavi nella directory del profilo utente e le mantiene protette tramite DPAPI con una chiave specifica per l'account utente usato per il pool di app.</span><span class="sxs-lookup"><span data-stu-id="485fa-238">This stores keys under the user profile directory and protects them using DPAPI with a key specific to the user account used for the app pool.</span></span>
* <span data-ttu-id="485fa-239">Modificare il codice dell'app per [usare il file system come archivio del gruppo di chiavi](xref:security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="485fa-239">Adjust your app code to [use the file system as a key ring store](xref:security/data-protection/configuration/overview).</span></span> <span data-ttu-id="485fa-240">Usare un certificato X509 per proteggere le chiavi e verificare che sia un certificato attendibile.</span><span class="sxs-lookup"><span data-stu-id="485fa-240">Use an X509 certificate to protect the keyring and ensure it's a trusted certificate.</span></span> <span data-ttu-id="485fa-241">Se si tratta di un certificato autofirmato è necessario inserirlo nell'archivio radice attendibile.</span><span class="sxs-lookup"><span data-stu-id="485fa-241">If it's a self signed certificate, you must place it in the Trusted Root store.</span></span>

<span data-ttu-id="485fa-242">Quando si usa IIS in una web farm:</span><span class="sxs-lookup"><span data-stu-id="485fa-242">When using IIS in a web farm:</span></span>

* <span data-ttu-id="485fa-243">Usare una condivisione di file a cui possono accedere tutti i computer.</span><span class="sxs-lookup"><span data-stu-id="485fa-243">Use a file share that all machines can access.</span></span>
* <span data-ttu-id="485fa-244">Distribuire un certificato X509 in ogni computer.</span><span class="sxs-lookup"><span data-stu-id="485fa-244">Deploy an X509 certificate to each machine.</span></span> <span data-ttu-id="485fa-245">Configurare [protezione dei dati nel codice](https://docs.microsoft.com/aspnet/core/security/data-protection/configuration/overview).</span><span class="sxs-lookup"><span data-stu-id="485fa-245">Configure [data protection in code](https://docs.microsoft.com/aspnet/core/security/data-protection/configuration/overview).</span></span>

### <a name="1-create-a-data-protection-registry-hive"></a><span data-ttu-id="485fa-246">1. Creare un Hive del Registro di sistema di protezione dei dati</span><span class="sxs-lookup"><span data-stu-id="485fa-246">1. Create a Data Protection Registry Hive</span></span>

<span data-ttu-id="485fa-247">Le chiavi di protezione dei dati usate dalle applicazioni ASP.NET vengono archiviate nell'hive del registro esterno alle applicazioni.</span><span class="sxs-lookup"><span data-stu-id="485fa-247">Data Protection keys used by ASP.NET applications are stored in registry hives external to the applications.</span></span> <span data-ttu-id="485fa-248">Per mantenere le chiavi per una determinata app è necessario creare un hive del registro per il pool di applicazioni dell'app.</span><span class="sxs-lookup"><span data-stu-id="485fa-248">To persist the keys for a given application, you must create a registry hive for the app's application pool.</span></span>

<span data-ttu-id="485fa-249">Per le installazioni IIS autonome è possibile usare lo [script PowerShell AutoGenKeys.ps1 - Effettuare il provisioning di protezione dei dati](https://github.com/aspnet/DataProtection/blob/dev/Provision-AutoGenKeys.ps1) per ogni pool di app usato con un'app ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="485fa-249">For standalone IIS installations, you may use the [Data Protection Provision-AutoGenKeys.ps1 PowerShell script](https://github.com/aspnet/DataProtection/blob/dev/Provision-AutoGenKeys.ps1) for each app pool used with an ASP.NET Core app.</span></span> <span data-ttu-id="485fa-250">Questo script crea una chiave del Registro di sistema speciale nel registro HKLM che viene inclusa nell'elenco di controllo di accesso (ACL) solo per l'account del processo di lavoro.</span><span class="sxs-lookup"><span data-stu-id="485fa-250">This script creates a special registry key in the HKLM registry that is ACLed only to the worker process account.</span></span> <span data-ttu-id="485fa-251">Le chiavi vengono crittografate a riposo tramite la DPAPI.</span><span class="sxs-lookup"><span data-stu-id="485fa-251">Keys are encrypted at rest using DPAPI.</span></span>

<span data-ttu-id="485fa-252">In scenari di web farm un'app può essere configurata in modo da usare un percorso UNC per archiviare il relativo gruppo di chiavi di protezione dei dati.</span><span class="sxs-lookup"><span data-stu-id="485fa-252">In web farm scenarios, an app can be configured to use a UNC path to store its data protection keyring.</span></span> <span data-ttu-id="485fa-253">Per impostazione predefinita, le chiavi di protezione dei dati non vengono crittografate.</span><span class="sxs-lookup"><span data-stu-id="485fa-253">By default, the data protection keys are not encrypted.</span></span> <span data-ttu-id="485fa-254">È necessario assicurarsi che le autorizzazioni file per una condivisione di questo tipo siano limitate all'applicazione che viene eseguita come account di Windows.</span><span class="sxs-lookup"><span data-stu-id="485fa-254">You should ensure that the file permissions for such a share are limited to the Windows account the app runs as.</span></span> <span data-ttu-id="485fa-255">È anche possibile scegliere di proteggere le chiavi a riposo con un certificato X509.</span><span class="sxs-lookup"><span data-stu-id="485fa-255">In addition, you may choose to protect keys at rest using an X509 certificate.</span></span> <span data-ttu-id="485fa-256">Prendere in considerazione l'implementazione di un meccanismo per consentire agli utenti di caricare i certificati: inserire i certificati nell'archivio certificati attendibili dell'utente e assicurarsi che siano disponibili in tutti i computer in cui viene eseguita l'app dell'utente.</span><span class="sxs-lookup"><span data-stu-id="485fa-256">You may wish to consider a mechanism to allow users to upload certificates: Place certificates into the user's trusted certificate store and ensure they're available on all machines where the user's app runs.</span></span> <span data-ttu-id="485fa-257">Vedere [Configurazione della protezione dati](xref:security/data-protection/configuration/overview) per altri dettagli.</span><span class="sxs-lookup"><span data-stu-id="485fa-257">See [Configuring Data Protection](xref:security/data-protection/configuration/overview) for details.</span></span>

### <a name="2-configure-the-iis-application-pool-to-load-the-user-profile"></a><span data-ttu-id="485fa-258">2. Configurare il Pool di applicazioni IIS per caricare il profilo utente</span><span class="sxs-lookup"><span data-stu-id="485fa-258">2. Configure the IIS Application Pool to load the user profile</span></span>

<span data-ttu-id="485fa-259">Questa impostazione si trova nella sezione **Modello del processo** in **Impostazioni avanzate** per il pool di app.</span><span class="sxs-lookup"><span data-stu-id="485fa-259">This setting is in the **Process Model** section under the **Advanced Settings** for the app pool.</span></span> <span data-ttu-id="485fa-260">Impostare Carica profilo utente su `True`.</span><span class="sxs-lookup"><span data-stu-id="485fa-260">Set Load User Profile to `True`.</span></span> <span data-ttu-id="485fa-261">Questa operazione archivia le chiavi nella directory del profilo utente e le mantiene protette tramite DPAPI con una chiave specifica per l'account utente usato per il pool di app.</span><span class="sxs-lookup"><span data-stu-id="485fa-261">This stores keys under the user profile directory and protects them using DPAPI with a key specific to the user account used for the app pool.</span></span>

### <a name="3-machine-wide-policy-for-data-protection"></a><span data-ttu-id="485fa-262">3. Criteri a livello di computer per la protezione dei dati</span><span class="sxs-lookup"><span data-stu-id="485fa-262">3. Machine-wide policy for data protection</span></span>

<span data-ttu-id="485fa-263">Il sistema di protezione dei dati ha un supporto limitato per l'impostazione di [criteri a livello di computer](xref:security/data-protection/configuration/machine-wide-policy) predefiniti per tutte le app che usano le API di protezione dei dati.</span><span class="sxs-lookup"><span data-stu-id="485fa-263">The data protection system has limited support for setting a default [machine-wide policy](xref:security/data-protection/configuration/machine-wide-policy) for all apps that consume the Data Protection APIs.</span></span> <span data-ttu-id="485fa-264">Vedere la documentazione sulla [protezione dei dati](xref:security/data-protection/index) per maggiori dettagli.</span><span class="sxs-lookup"><span data-stu-id="485fa-264">See the [data protection](xref:security/data-protection/index) documentation for more details.</span></span>

## <a name="configuration-of-sub-applications"></a><span data-ttu-id="485fa-265">Configurazione delle sotto-applicazioni</span><span class="sxs-lookup"><span data-stu-id="485fa-265">Configuration of sub-applications</span></span>

<span data-ttu-id="485fa-266">Sotto applicazioni aggiunte sotto l'applicazione della radice non devono includere il modulo di ASP.NET Core come gestore.</span><span class="sxs-lookup"><span data-stu-id="485fa-266">Sub applications added under the root application shouldn't include the ASP.NET Core Module as a handler.</span></span> <span data-ttu-id="485fa-267">Se si aggiunge il modulo come gestore nel file *web.config* di una sotto-applicazione, quando si prova a esplorare la sotto-applicazione si riceve un errore 500.19 (Errore interno del server) relativo al file di configurazione con errori.</span><span class="sxs-lookup"><span data-stu-id="485fa-267">If you add the module as a handler in a sub-application's *web.config* file, you receive a 500.19 (Internal Server Error) referencing the faulty config file when you attempt to browse the sub-app.</span></span> <span data-ttu-id="485fa-268">Nell'esempio seguente viene illustrato il contenuto di un file *web.config* pubblicato per una sotto-app di ASP.NET Core:</span><span class="sxs-lookup"><span data-stu-id="485fa-268">The following example shows the contents of a published *web.config* file for an ASP.NET Core sub-app:</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.webServer>
    <aspNetCore processPath="dotnet" 
      arguments=".\MyApp.dll" 
      stdoutLogEnabled="false" 
      stdoutLogFile=".\logs\stdout" />
  </system.webServer>
</configuration>
```

<span data-ttu-id="485fa-269">Se si intende ospitare una sotto-app non ASP.NET Core in un'app ASP.NET Core, è necessario rimuovere in modo esplicito il gestore ereditato nel file *web.config* della sotto-app:</span><span class="sxs-lookup"><span data-stu-id="485fa-269">If you intend to host a non-ASP.NET Core sub-app underneath an ASP.NET Core app, you must explicitly remove the inherited handler in the sub-app *web.config* file:</span></span>

```xml
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.webServer>
    <handlers>
      <remove name="aspNetCore"/>
    </handlers>
    <aspNetCore processPath="dotnet" 
      arguments=".\MyApp.dll" 
      stdoutLogEnabled="false" 
      stdoutLogFile=".\logs\stdout" />
  </system.webServer>
</configuration>
```

<span data-ttu-id="485fa-270">Per altre informazioni sulla configurazione del modulo di ASP.NET Core con il file *web.config*, vedere l'argomento[Introduzione al modulo di ASP.NET Core](xref:fundamentals/servers/aspnet-core-module) e il [riferimento alla configurazione del modulo di ASP.NET Core](xref:hosting/aspnet-core-module).</span><span class="sxs-lookup"><span data-stu-id="485fa-270">For more information on configuring the ASP.NET Core Module with the *web.config* file, see the [Introduction to ASP.NET Core Module](xref:fundamentals/servers/aspnet-core-module) topic and the [ASP.NET Core Module configuration reference](xref:hosting/aspnet-core-module).</span></span>

## <a name="configuration-of-iis-with-webconfig"></a><span data-ttu-id="485fa-271">Configurazione di IIS con web.config</span><span class="sxs-lookup"><span data-stu-id="485fa-271">Configuration of IIS with web.config</span></span>

<span data-ttu-id="485fa-272">La configurazione di IIS è comunque influenzata dalla sezione `<system.webServer>` di *web.config* per tali funzionalità IIS che si applicano a una configurazione di proxy inverso.</span><span class="sxs-lookup"><span data-stu-id="485fa-272">IIS configuration is still influenced by the `<system.webServer>` section of *web.config* for those IIS features that apply to a reverse proxy configuration.</span></span> <span data-ttu-id="485fa-273">Ad esempio, è possibile disporre della IIS configurata a livello di sistema per usare la compressione dinamica, ma è possibile disabilitare questa impostazione per un'app con l'elemento `<urlCompression>` nel file dell'app *web.config*.</span><span class="sxs-lookup"><span data-stu-id="485fa-273">For example, you may have IIS configured at the system level to use dynamic compression, but you could disable that setting for an app with the `<urlCompression>` element in the app's *web.config* file.</span></span> <span data-ttu-id="485fa-274">Per altre informazioni, vedere il [riferimento per la configurazione di `<system.webServer>`](https://docs.microsoft.com/iis/configuration/system.webServer/), il [Riferimento per la configurazione del modulo ASP.NET Core](xref:hosting/aspnet-core-module) e [Uso dei moduli IIS con ASP.NET Core](xref:hosting/iis-modules).</span><span class="sxs-lookup"><span data-stu-id="485fa-274">For more information, see the [configuration reference for `<system.webServer>`](https://docs.microsoft.com/iis/configuration/system.webServer/), [ASP.NET Core Module Configuration Reference](xref:hosting/aspnet-core-module) and [Using IIS Modules with ASP.NET Core](xref:hosting/iis-modules).</span></span> <span data-ttu-id="485fa-275">Se è necessario impostare le variabili di ambiente per le singole app in esecuzione nel pool di applicazioni isolate (supportate in IIS 10.0+), vedere la sezione *Comando AppCmd.exe* dell'argomento [Variabili di ambiente \<environmentVariables >](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) nella documentazione di riferimento.</span><span class="sxs-lookup"><span data-stu-id="485fa-275">If you need to set environment variables for individual apps running in isolated Application Pools (supported on IIS 10.0+), see the *AppCmd.exe command* section of the [Environment Variables \<environmentVariables>](/iis/configuration/system.applicationHost/applicationPools/add/environmentVariables/#appcmdexe) topic in the IIS reference documentation.</span></span>

## <a name="configuration-sections-of-webconfig"></a><span data-ttu-id="485fa-276">Sezioni di configurazione di web.config</span><span class="sxs-lookup"><span data-stu-id="485fa-276">Configuration sections of web.config</span></span>

<span data-ttu-id="485fa-277">A differenza delle applicazioni .NET Framework che sono configurate con gli elementi `<system.web>`, `<appSettings>`, `<connectionStrings>`, e `<location>` in *web.config*, le app ASP.NET Core vengono configurate tramite altri provider di configurazione.</span><span class="sxs-lookup"><span data-stu-id="485fa-277">Unlike .NET Framework applications that are configured with the `<system.web>`, `<appSettings>`, `<connectionStrings>`, and `<location>` elements in *web.config*, ASP.NET Core apps are configured using other configuration providers.</span></span> <span data-ttu-id="485fa-278">Per altre informazioni, vedere [Configurazione](xref:fundamentals/configuration/index).</span><span class="sxs-lookup"><span data-stu-id="485fa-278">For more information, see [Configuration](xref:fundamentals/configuration/index).</span></span>

## <a name="application-pools"></a><span data-ttu-id="485fa-279">Pool di applicazioni</span><span class="sxs-lookup"><span data-stu-id="485fa-279">Application Pools</span></span>

<span data-ttu-id="485fa-280">Quando si ospitano più siti Web in un unico sistema, è necessario isolare le app le une dalle altre eseguendo ogni app nel pool di applicazioni corrispondente.</span><span class="sxs-lookup"><span data-stu-id="485fa-280">When hosting multiple websites on a single system, you should isolate the apps from each other by running each app in its own application pool.</span></span> <span data-ttu-id="485fa-281">La finestra di dialogo di IIS **Aggiungi sito Web** ha per impostazione predefinita questo comportamento.</span><span class="sxs-lookup"><span data-stu-id="485fa-281">The IIS **Add Website** dialog defaults to this behavior.</span></span> <span data-ttu-id="485fa-282">Quando si fornisce un **Nome del sito**, il testo viene automaticamente trasferito alla casella di testo **Pool di applicazioni**.</span><span class="sxs-lookup"><span data-stu-id="485fa-282">When you provide a **Site name**, the text is automatically transferred to the **Application pool** textbox.</span></span> <span data-ttu-id="485fa-283">Quando si aggiunge il sito Web viene creato un nuovo pool di applicazioni con il nome del sito.</span><span class="sxs-lookup"><span data-stu-id="485fa-283">A new application pool is created using the site name when you add the website.</span></span>

## <a name="application-pool-identity"></a><span data-ttu-id="485fa-284">Identità del pool di applicazione</span><span class="sxs-lookup"><span data-stu-id="485fa-284">Application Pool Identity</span></span>

<span data-ttu-id="485fa-285">Un account di identità di pool di applicazioni consente di eseguire un'applicazione in un account univoco senza la necessità di creare e gestire i domini o gli account locali.</span><span class="sxs-lookup"><span data-stu-id="485fa-285">An application pool identity account allows you to run an application under a unique account without having to create and manage domains or local accounts.</span></span> <span data-ttu-id="485fa-286">In IIS 8.0+ il processo di lavoro amministrazione IIS (WAS) crea un account virtuale con il nome del nuovo pool di applicazioni ed esegue i processi di lavoro del pool di applicazioni inclusi nell'account per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="485fa-286">On IIS 8.0+, the IIS Admin Worker Process (WAS) creates a virtual account with the name of the new application pool and runs the app pool's worker processes under this account by default.</span></span> <span data-ttu-id="485fa-287">Nella Console di gestione IIS in **Impostazioni avanzate** per il pool di app verificare che **Identità** sia impostata su **ApplicationPoolIdentity** come illustrato nell'immagine seguente.</span><span class="sxs-lookup"><span data-stu-id="485fa-287">In the IIS Management Console under **Advanced Settings** for your app pool, ensure that the **Identity** is set to use **ApplicationPoolIdentity** as shown in the image below.</span></span>

![Finestra di dialogo Impostazioni avanzate del pool di applicazione](iis/_static/apppool-identity.png)

<span data-ttu-id="485fa-289">Il processo di gestione IIS crea un identificatore sicuro con il nome del pool di app nel sistema di sicurezza di Windows.</span><span class="sxs-lookup"><span data-stu-id="485fa-289">The IIS management process creates a secure identifier with the name of the app pool in the Windows Security System.</span></span> <span data-ttu-id="485fa-290">È possibile proteggere le risorse con questa identità, che tuttavia non è un account utente reale e non viene visualizzata nella Console di gestione utenti di Windows.</span><span class="sxs-lookup"><span data-stu-id="485fa-290">Resources can be secured by using this identity; however, this identity isn't a real user account and won't show up in the Windows User Management Console.</span></span>

<span data-ttu-id="485fa-291">Per concedere al processo di lavoro IIS l'accesso con privilegi elevati all'applicazione sarà necessario modificare l'elenco di controllo di accesso (ACL) per la directory che contiene l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="485fa-291">If you need to grant the IIS worker process elevated access to your app, you must modify the Access Control List (ACL) for the directory containing your application.</span></span>

1. <span data-ttu-id="485fa-292">Aprire Esplora risorse, quindi spostarsi nella directory.</span><span class="sxs-lookup"><span data-stu-id="485fa-292">Open Windows Explorer and navigate to the directory.</span></span>

2. <span data-ttu-id="485fa-293">Fare clic con il pulsante destro sulla directory e fare clic su **Proprietà**.</span><span class="sxs-lookup"><span data-stu-id="485fa-293">Right click on the directory and click **Properties**.</span></span>

3. <span data-ttu-id="485fa-294">Sotto la scheda **Sicurezza**, fare clic sul pulsante **Modifica** pulsante e quindi il pulsante **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="485fa-294">Under the **Security** tab, click the **Edit** button and then the **Add** button.</span></span>

4. <span data-ttu-id="485fa-295">Fare clic su di **percorsi** pulsante e assicurarsi di selezionare il sistema.</span><span class="sxs-lookup"><span data-stu-id="485fa-295">Click the **Locations** button and make sure you select your system.</span></span>

5. <span data-ttu-id="485fa-296">Immettere **IIS AppPool\DefaultAppPool** nella casella di testo **Immettere i nomi degli oggetti da selezionare**.</span><span class="sxs-lookup"><span data-stu-id="485fa-296">Enter **IIS AppPool\DefaultAppPool** in **Enter the object names to select** textbox.</span></span>

  ![Selezionare la finestra di dialogo degli utenti o dei gruppi per la cartella dell'applicazione](iis/_static/select-users-or-groups-1.png)

6. <span data-ttu-id="485fa-298">Fare clic sul pulsante **Controlla nomi** e quindi fare clic su **OK**.</span><span class="sxs-lookup"><span data-stu-id="485fa-298">Click the **Check Names** button and then click **OK**.</span></span>

  ![Selezionare la finestra di dialogo degli utenti o dei gruppi per la cartella dell'applicazione](iis/_static/select-users-or-groups-2.png)

<span data-ttu-id="485fa-300">È possibile farlo anche tramite un prompt dei comandi usando lo strumento **ICACLS**:</span><span class="sxs-lookup"><span data-stu-id="485fa-300">You can also do this via a command prompt using **ICACLS** tool:</span></span>

```console
ICACLS C:\sites\MyWebApp /grant "IIS AppPool\DefaultAppPool":F
```

## <a name="troubleshooting-tips"></a><span data-ttu-id="485fa-301">Suggerimenti per la risoluzione dei problemi</span><span class="sxs-lookup"><span data-stu-id="485fa-301">Troubleshooting tips</span></span>

<span data-ttu-id="485fa-302">Per diagnosticare i problemi delle distribuzioni IIS:</span><span class="sxs-lookup"><span data-stu-id="485fa-302">To diagnose problems with IIS deployments:</span></span>

* <span data-ttu-id="485fa-303">Esaminare l'output del browser.</span><span class="sxs-lookup"><span data-stu-id="485fa-303">Study browser output.</span></span>
* <span data-ttu-id="485fa-304">Esaminare il **registro applicazioni** del sistema con il **Visualizzatore eventi**.</span><span class="sxs-lookup"><span data-stu-id="485fa-304">Examine the system's **Application** log through **Event Viewer**.</span></span>
* <span data-ttu-id="485fa-305">Abilitare la registrazione `stdout`.</span><span class="sxs-lookup"><span data-stu-id="485fa-305">Enable `stdout` logging.</span></span> <span data-ttu-id="485fa-306">Il registro **Modulo ASP.NET Core** si trova nel percorso specificato nell'attributo *stdoutLogFile* dell'elemento `<aspNetCore>` in *web.config*. Le cartelle nel percorso fornito nel valore dell'attributo devono essere presenti nella distribuzione.</span><span class="sxs-lookup"><span data-stu-id="485fa-306">The **ASP.NET Core Module** log is found on the path provided in the *stdoutLogFile* attribute of the `<aspNetCore>` element in *web.config*. Any folders on the path provided in the attribute value must exist in the deployment.</span></span> <span data-ttu-id="485fa-307">È anche necessario impostare *stdoutLogEnabled = "true"*.</span><span class="sxs-lookup"><span data-stu-id="485fa-307">You must also set *stdoutLogEnabled="true"*.</span></span> <span data-ttu-id="485fa-308">Nelle app che usano l'SDK `Microsoft.NET.Sdk.Web` per creare il file *web.config* l'impostazione predefinita di *stdoutLogEnabled* è *false*, pertanto è necessario specificare manualmente il file *web.config* o modificare il file per consentire la registrazione `stdout`.</span><span class="sxs-lookup"><span data-stu-id="485fa-308">Apps that use the the `Microsoft.NET.Sdk.Web` SDK to create the *web.config* file default the *stdoutLogEnabled* setting to *false*, so you must manually provide the *web.config* file or modify the file in order to enable `stdout` logging.</span></span>

<span data-ttu-id="485fa-309">Molti errori comuni non vengono visualizzati nel browser, nel registro applicazioni e nel registro del modulo ASP.NET Core fino a quando non vengono superate le impostazioni *startupTimeLimit* (impostazione predefinita: 120 secondi) e *startupRetryCount* (impostazione predefinita: 2) del modulo.</span><span class="sxs-lookup"><span data-stu-id="485fa-309">Several of the common errors don't appear in the browser, Application Log, and ASP.NET Core Module Log until the module *startupTimeLimit* (default: 120 seconds) and *startupRetryCount* (default: 2) have passed.</span></span> <span data-ttu-id="485fa-310">Attendere almeno sei minuti prima di dedurre che il modulo non è riuscito ad avviare un processo per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="485fa-310">Therefore, wait a full six minutes before deducing that the module has failed to start a process for the app.</span></span>

<span data-ttu-id="485fa-311">Un modo veloce per determinare se l'app funziona correttamente è l'esecuzione dell'app direttamente su Kestrel.</span><span class="sxs-lookup"><span data-stu-id="485fa-311">One quick way to determine if the app is working properly is to run the app directly on Kestrel.</span></span> <span data-ttu-id="485fa-312">Se l'app è stata pubblicata come distribuzione dipendente dal framework, eseguire `dotnet my_application.dll` nella cartella di distribuzione, che è il percorso fisico IIS per l'app.</span><span class="sxs-lookup"><span data-stu-id="485fa-312">If the app was published as a framework-dependent deployment (FDD), execute `dotnet my_application.dll` in the deployment folder, which is the IIS physical path to the app.</span></span> <span data-ttu-id="485fa-313">Se l'app è stata pubblicata come distribuzione indipendente, eseguire il file eseguibile dell'app `my_application.exe` direttamente al prompt dei comandi nella cartella di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="485fa-313">If the app was published as a self-contained deployment (SCD), run the app's executable directly from a command prompt, `my_application.exe`, in the deployment folder.</span></span> <span data-ttu-id="485fa-314">Se Kestrel è in ascolto sulla porta predefinita 5000, deve essere possibile passare all'app in `http://localhost:5000/`.</span><span class="sxs-lookup"><span data-stu-id="485fa-314">If Kestrel is listening on default port 5000, you should be able to browse the app at `http://localhost:5000/`.</span></span> <span data-ttu-id="485fa-315">Se l'app risponde normalmente nell'indirizzo endpoint di Kestrel, è più probabile che il problema sia associato alla configurazione IIS/modulo ASP.NET Core/Kestrel e meno probabile che sia interno all'app stessa.</span><span class="sxs-lookup"><span data-stu-id="485fa-315">If the app responds normally at the Kestrel endpoint address, the problem is more likely related to the IIS-ASP.NET Core Module-Kestrel configuration and less likely within the app itself.</span></span>

<span data-ttu-id="485fa-316">Un modo per determinare se il proxy inverso IIS per il server Kestrel funziona correttamente è l'esecuzione una richiesta semplice di file statici per un foglio di stile, uno script o un'immagine dai file statici dell'app in *wwwroot* tramite il [middleware per i file statici](xref:fundamentals/static-files).</span><span class="sxs-lookup"><span data-stu-id="485fa-316">One way to determine if the IIS reverse proxy to the Kestrel server is working properly is to perform a simple static file request for a stylesheet, script, or image from the app's static files in *wwwroot* using [Static File middleware](xref:fundamentals/static-files).</span></span> <span data-ttu-id="485fa-317">Se l'app è attiva per i file statici ma non per le visualizzazioni MVC e gli altri endpoint, è meno probabile che il problema sia associato alla configurazione IIS/modulo ASP.NET Core/Kestrel e più probabile che sia interno all'app stessa (ad esempio un problema di routing MVC o un errore 500 - Errore interno del server).</span><span class="sxs-lookup"><span data-stu-id="485fa-317">If the app can serve static files but MVC Views and other endpoints are failing, the problem is less likely related to the IIS-ASP.NET Core Module-Kestrel configuration and more likely within the app itself (for example, MVC routing or 500 Internal Server Error).</span></span>

<span data-ttu-id="485fa-318">Quando viene avviato normalmente Kestrel dietro IIS, ma l'app non verrà eseguita nel sistema dopo averla correttamente eseguita in locale, è possibile aggiungere temporaneamente una variabile di ambiente per *web.config* per impostare il `ASPNETCORE_ENVIRONMENT` su `Development`.</span><span class="sxs-lookup"><span data-stu-id="485fa-318">When Kestrel starts normally behind IIS but the app won't run on the system after successfully running locally, you can temporarily add an environment variable to *web.config* to set the `ASPNETCORE_ENVIRONMENT` to `Development`.</span></span> <span data-ttu-id="485fa-319">Se all'avvio dell'app non viene eseguito l'override dell'ambiente, quando l'app viene eseguita nel sistema viene visualizzata la [pagina delle eccezioni per lo sviluppatore](xref:fundamentals/error-handling).</span><span class="sxs-lookup"><span data-stu-id="485fa-319">As long as you don't override the environment in app startup, this allows the [developer exception page](xref:fundamentals/error-handling) to appear when the app is run on the system.</span></span> <span data-ttu-id="485fa-320">L'impostazione della variabile di ambiente per `ASPNETCORE_ENVIRONMENT` con questo metodo è consigliata solo per i sistemi di gestione temporanea/test non esposti a Internet.</span><span class="sxs-lookup"><span data-stu-id="485fa-320">Setting the environment variable for `ASPNETCORE_ENVIRONMENT` in this way is only recommended for staging/testing systems that aren't exposed to the Internet.</span></span> <span data-ttu-id="485fa-321">Assicurarsi di rimuovere la variabile di ambiente dal file *web.config* al termine del file.</span><span class="sxs-lookup"><span data-stu-id="485fa-321">Be sure you remove the environment variable from the *web.config* file when finished.</span></span> <span data-ttu-id="485fa-322">Per informazioni sull'impostazione delle variabili di ambiente tramite *web.config* per il proxy inverso, vedere [elemento figlio environmentVariables di aspNetCore](xref:hosting/aspnet-core-module#setting-environment-variables).</span><span class="sxs-lookup"><span data-stu-id="485fa-322">For information on setting environment variables via *web.config* for the reverse proxy, see [environmentVariables child element of aspNetCore](xref:hosting/aspnet-core-module#setting-environment-variables).</span></span>

<span data-ttu-id="485fa-323">Nella maggior parte dei casi l'abilitazione della registrazione dell'applicazione è utile per risolvere i problemi dell'applicazione o del proxy inverso.</span><span class="sxs-lookup"><span data-stu-id="485fa-323">In most cases, enabling application logging assists in troubleshooting problems with the app or the reverse proxy.</span></span> <span data-ttu-id="485fa-324">Per altre informazioni, vedere [Registrazione](xref:fundamentals/logging/index).</span><span class="sxs-lookup"><span data-stu-id="485fa-324">See [Logging](xref:fundamentals/logging/index) for more information.</span></span>

<span data-ttu-id="485fa-325">L'ultimo suggerimento di risoluzione dei problemi è relativo alle app che non vengono eseguite dopo l'aggiornamento di .NET Core SDK nelle versioni computer o pacchetto di sviluppo all'interno dell'app.</span><span class="sxs-lookup"><span data-stu-id="485fa-325">Our last troubleshooting tip pertains to apps that fail to run after upgrading either the .NET Core SDK on the development machine or package versions within the app.</span></span> <span data-ttu-id="485fa-326">In alcuni casi i pacchetti incoerenti possono interrompere un'app quando si eseguono aggiornamenti principali.</span><span class="sxs-lookup"><span data-stu-id="485fa-326">In some cases, incoherent packages may break an app when performing major upgrades.</span></span> <span data-ttu-id="485fa-327">È possibile risolvere la maggior parte di questi problemi eliminando le cartelle `bin` e `obj` nel progetto, cancellando le caches del pacchetto in `%UserProfile%\.nuget\packages\` e `%LocalAppData%\Nuget\v3-cache`, ripristinando il progetto e confermando che la distribuzione precedente sul sistema è stata eliminata completamente prima di distribuire nuovamente l'app.</span><span class="sxs-lookup"><span data-stu-id="485fa-327">You can fix most of these issues by deleting the `bin` and `obj` folders in the project, clearing package caches at `%UserProfile%\.nuget\packages\` and `%LocalAppData%\Nuget\v3-cache`, restoring the project, and confirming that your prior deployment on the system has been completely deleted prior to re-deploying the app.</span></span>

> [!TIP]
> <span data-ttu-id="485fa-328">Un metodo pratico per cancellare le cache dei pacchetti è ottenere lo strumento *NuGet.exe* da [NuGet.org](https://www.nuget.org/), aggiungerlo al percorso di sistema ed eseguire `nuget locals all -clear` al prompt dei comandi.</span><span class="sxs-lookup"><span data-stu-id="485fa-328">A convenient way to clear package caches is to obtain the *NuGet.exe* tool from [NuGet.org](https://www.nuget.org/), add it to your system PATH, and execute `nuget locals all -clear` from a command prompt.</span></span> <span data-ttu-id="485fa-329">È anche possibile eseguire il comando `dotnet nuget locals all --clear` al prompt dei comandi senza avere *NuGet.exe*.</span><span class="sxs-lookup"><span data-stu-id="485fa-329">You can also execute the `dotnet nuget locals all --clear` command from a command prompt without obtaining *NuGet.exe*.</span></span>

## <a name="common-errors"></a><span data-ttu-id="485fa-330">Errori comuni</span><span class="sxs-lookup"><span data-stu-id="485fa-330">Common errors</span></span>

<span data-ttu-id="485fa-331">L'elenco di errori che segue non è completo.</span><span class="sxs-lookup"><span data-stu-id="485fa-331">The following isn't a complete list of errors.</span></span> <span data-ttu-id="485fa-332">Qualora si incontrasse un errore che non è presente qui, lasciare un messaggio di errore dettagliato nella sezione commenti.</span><span class="sxs-lookup"><span data-stu-id="485fa-332">Should you encounter an error not listed here, please leave a detailed error message in the comments section below.</span></span>

### <a name="installer-unable-to-obtain-vc-redistributable"></a><span data-ttu-id="485fa-333">Il programma di installazione non riesce ad ottenere VC++ Ridistribuibile</span><span class="sxs-lookup"><span data-stu-id="485fa-333">Installer unable to obtain VC++ Redistributable</span></span>

* <span data-ttu-id="485fa-334">**Eccezione del programma di installazione:** 0x80072efd o 0x80072f76 - Errore non specificato</span><span class="sxs-lookup"><span data-stu-id="485fa-334">**Installer Exception:** 0x80072efd or 0x80072f76 - Unspecified error</span></span>

* <span data-ttu-id="485fa-335">**Installer Log Exception&#8224;:** Error 0x80072efd oppure0x80072f76: Impossibile eseguire i file EXE del pacchetto</span><span class="sxs-lookup"><span data-stu-id="485fa-335">**Installer Log Exception&#8224;:** Error 0x80072efd or 0x80072f76: Failed to execute EXE package</span></span>

  <span data-ttu-id="485fa-336">&#8224; Il log si trova in C:\Users\\{USER}\AppData\Local\Temp\dd_DotNetCoreWinSvrHosting__{timestamp}.log.</span><span class="sxs-lookup"><span data-stu-id="485fa-336">&#8224;The log is located at C:\Users\\{USER}\AppData\Local\Temp\dd_DotNetCoreWinSvrHosting__{timestamp}.log.</span></span>

<span data-ttu-id="485fa-337">Risoluzione dei problemi:</span><span class="sxs-lookup"><span data-stu-id="485fa-337">Troubleshooting:</span></span>

* <span data-ttu-id="485fa-338">Se il sistema non ha accesso a Internet durante l'installazione dell'aggregazione di hosting del server, questa eccezione si verifica quando il programma di installazione non riesce ad ottenere *Microsoft Visual C++ 2015 Redistributable*.</span><span class="sxs-lookup"><span data-stu-id="485fa-338">If the system doesn't have Internet access while installing the server hosting bundle, this exception occurs when the installer is prevented from obtaining the *Microsoft Visual C++ 2015 Redistributable*.</span></span> <span data-ttu-id="485fa-339">È possibile ottenere un programma di installazione da [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=53840).</span><span class="sxs-lookup"><span data-stu-id="485fa-339">You may obtain an installer from the [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=53840).</span></span> <span data-ttu-id="485fa-340">Se l'esecuzione del programma di installazione non riesce, è possibile che non si riceva il runtime .NET Core necessario per ospitare una distribuzione dipendente dal framework (FDD, Framework-Dependent Deployment).</span><span class="sxs-lookup"><span data-stu-id="485fa-340">If the installer fails, you may not receive the .NET Core runtime required to host a framework-dependent deployment (FDD).</span></span> <span data-ttu-id="485fa-341">Se si prevede di ospitare una distribuzione dipendente dal framework, verificare che il runtime sia installato in Programmi &amp; Funzionalità.</span><span class="sxs-lookup"><span data-stu-id="485fa-341">If you plan to host an FDD, confirm that the runtime is installed in Programs &amp; Features.</span></span> <span data-ttu-id="485fa-342">È possibile ottenere un programma di installazione di runtime da [Download .NET](https://www.microsoft.com/net/download/core).</span><span class="sxs-lookup"><span data-stu-id="485fa-342">You may obtain a runtime installer from [.NET Downloads](https://www.microsoft.com/net/download/core).</span></span> <span data-ttu-id="485fa-343">Dopo aver installato il runtime, riavviare il sistema o riavviare IIS eseguendo **net stop was /y** seguito da **net start w3svc** da un prompt dei comandi.</span><span class="sxs-lookup"><span data-stu-id="485fa-343">After installing the runtime, restart the system or restart IIS by executing **net stop was /y** followed by **net start w3svc** from a command prompt.</span></span>

### <a name="os-upgrade-removed-the-32-bit-aspnet-core-module"></a><span data-ttu-id="485fa-344">L'aggiornamento del sistema operativo ha rimosso il modulo di ASP.NET Core a 32 bit</span><span class="sxs-lookup"><span data-stu-id="485fa-344">OS upgrade removed the 32-bit ASP.NET Core Module</span></span>

* <span data-ttu-id="485fa-345">**Registro dell'applicazione:** Il modulo DLL**C:\WINDOWS\system32\inetsrv\aspnetcore.dll** non è riuscito a caricare.</span><span class="sxs-lookup"><span data-stu-id="485fa-345">**Application Log:** The Module DLL **C:\WINDOWS\system32\inetsrv\aspnetcore.dll** failed to load.</span></span> <span data-ttu-id="485fa-346">L'errore è nei dati.</span><span class="sxs-lookup"><span data-stu-id="485fa-346">The data is the error.</span></span>

<span data-ttu-id="485fa-347">Risoluzione dei problemi:</span><span class="sxs-lookup"><span data-stu-id="485fa-347">Troubleshooting:</span></span>

* <span data-ttu-id="485fa-348">I file non appartenenti al sistema operativo presenti nella directory **C:\Windows\SysWOW64\inetsrv** non vengono mantenuti durante un aggiornamento del sistema operativo.</span><span class="sxs-lookup"><span data-stu-id="485fa-348">Non-OS files in the **C:\Windows\SysWOW64\inetsrv** directory aren't preserved during an OS upgrade.</span></span> <span data-ttu-id="485fa-349">Se il modulo ASP.NET Core viene installato prima di un aggiornamento del sistema operativo e quindi si prova a eseguire qualsiasi pool di applicazioni in modalità a 32 bit dopo l'aggiornamento, si verifica questo problema.</span><span class="sxs-lookup"><span data-stu-id="485fa-349">If you have the ASP.NET Core Module installed prior to an OS upgrade and then try to run any AppPool in 32-bit mode after an OS upgrade, you encounter this issue.</span></span> <span data-ttu-id="485fa-350">Dopo un aggiornamento del sistema operativo, ripristinare il Modulo di ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="485fa-350">After an OS upgrade, repair the ASP.NET Core Module.</span></span> <span data-ttu-id="485fa-351">Vedere [Installare l'aggregazione di Hosting di.NET Core Windows Server](#install-the-net-core-windows-server-hosting-bundle).</span><span class="sxs-lookup"><span data-stu-id="485fa-351">See [Install the .NET Core Windows Server Hosting bundle](#install-the-net-core-windows-server-hosting-bundle).</span></span> <span data-ttu-id="485fa-352">Selezionare **Ripara** quando si esegue il programma di installazione.</span><span class="sxs-lookup"><span data-stu-id="485fa-352">Select **Repair** when you run the installer.</span></span>

### <a name="platform-conflicts-with-rid"></a><span data-ttu-id="485fa-353">La piattaforma è in conflitto con RID</span><span class="sxs-lookup"><span data-stu-id="485fa-353">Platform conflicts with RID</span></span>

* <span data-ttu-id="485fa-354">**Browser:** errore HTTP 502.5 - errore del processo</span><span class="sxs-lookup"><span data-stu-id="485fa-354">**Browser:** HTTP Error 502.5 - Process Failure</span></span>

* <span data-ttu-id="485fa-355">**Registro dell'applicazione:** l'applicazione "MACHINE/WEBROOT/APPHOST/MY_APPLICATION" con radice fisica "C:\{PATH}\' Impossibile avviare il processo con la riga di comando""C:\\{PATH}\my_application.{exe|dll}" ", ErrorCode = "0x80004005 : ff.</span><span class="sxs-lookup"><span data-stu-id="485fa-355">**Application Log:** Application 'MACHINE/WEBROOT/APPHOST/MY_APPLICATION' with physical root 'C:\{PATH}\' failed to start process with commandline '"C:\\{PATH}\my_application.{exe|dll}" ', ErrorCode = '0x80004005 : ff.</span></span>

* <span data-ttu-id="485fa-356">**Registro del modulo ASP.NET Core:** Eccezione non gestita: System.BadImageFormatException: Impossibile caricare il file o l'assembly "my_application.dll".</span><span class="sxs-lookup"><span data-stu-id="485fa-356">**ASP.NET Core Module Log:** Unhandled Exception: System.BadImageFormatException: Could not load file or assembly 'my_application.dll'.</span></span> <span data-ttu-id="485fa-357">Tentativo di caricare un programma con un formato non corretto.</span><span class="sxs-lookup"><span data-stu-id="485fa-357">An attempt was made to load a program with an incorrect format.</span></span>

<span data-ttu-id="485fa-358">Risoluzione dei problemi:</span><span class="sxs-lookup"><span data-stu-id="485fa-358">Troubleshooting:</span></span>

* <span data-ttu-id="485fa-359">Confermare che l'applicazione venga eseguita in locale su Kestrel.</span><span class="sxs-lookup"><span data-stu-id="485fa-359">Confirm that the application runs locally on Kestrel.</span></span> <span data-ttu-id="485fa-360">Un errore del processo può essere il risultato di un problema all'interno dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="485fa-360">A process failure might be the result of a problem within the application.</span></span> <span data-ttu-id="485fa-361">Per altre informazioni, vedere [Consigli per la risoluzione dei problemi](#troubleshooting-tips).</span><span class="sxs-lookup"><span data-stu-id="485fa-361">For more information, see [Troubleshooting tips](#troubleshooting-tips).</span></span>

* <span data-ttu-id="485fa-362">Confermare di non aver impostato un `<PlatformTarget>` nel *csproj* che è in conflitto con il RID.</span><span class="sxs-lookup"><span data-stu-id="485fa-362">Confirm that you didn't set a `<PlatformTarget>` in your *.csproj* that conflicts with the RID.</span></span> <span data-ttu-id="485fa-363">Ad esempio, non specificare un `<PlatformTarget>` di `x86` e pubblicare con un RID di `win10-x64`, tramite l'uso di *dotnet publish - c Release -r win10-x64* o impostando `<RuntimeIdentifiers>` nel *csproj* su `win10-x64`.</span><span class="sxs-lookup"><span data-stu-id="485fa-363">For example, don't specify a `<PlatformTarget>` of `x86` and publish with an RID of `win10-x64`, either by using *dotnet publish -c Release -r win10-x64* or by setting the `<RuntimeIdentifiers>` in your *.csproj* to `win10-x64`.</span></span> <span data-ttu-id="485fa-364">Il progetto viene pubblicato senza avvisi o errori, ma la sua esecuzione non riesce e nel sistema vengono registrate le eccezioni sopra indicate.</span><span class="sxs-lookup"><span data-stu-id="485fa-364">The project publishes without warning or error but fails with the above logged exceptions on the system.</span></span>

* <span data-ttu-id="485fa-365">Se questa eccezione si verifica per una distribuzione di App di Azure durante l'aggiornamento di un'applicazione e la distribuzione di assembly più recenti, eliminare manualmente tutti i file dalla distribuzione precedente.</span><span class="sxs-lookup"><span data-stu-id="485fa-365">If this exception occurs for an Azure Apps deployment when upgrading an application and deploying newer assemblies, manually delete all files from the prior deployment.</span></span> <span data-ttu-id="485fa-366">Le assembly incompatibili con il tempo di ritardo possono causare una eccezione `System.BadImageFormatException` quando si distribuisce un'app aggiornata.</span><span class="sxs-lookup"><span data-stu-id="485fa-366">Lingering incompatible assemblies can result in a `System.BadImageFormatException` exception when deploying an upgraded app.</span></span>

### <a name="uri-endpoint-wrong-or-stopped-website"></a><span data-ttu-id="485fa-367">Endpoint dell'URI non corretto o sito web arrestato</span><span class="sxs-lookup"><span data-stu-id="485fa-367">URI endpoint wrong or stopped website</span></span>

* <span data-ttu-id="485fa-368">**Browser:** ERR_CONNECTION_REFUSED</span><span class="sxs-lookup"><span data-stu-id="485fa-368">**Browser:** ERR_CONNECTION_REFUSED</span></span>

* <span data-ttu-id="485fa-369">**Registro dell'applicazione:** Nessuna voce</span><span class="sxs-lookup"><span data-stu-id="485fa-369">**Application Log:** No entry</span></span>

* <span data-ttu-id="485fa-370">**Registro del modulo di ASP.NET Core:** il file di registro non è stato creato</span><span class="sxs-lookup"><span data-stu-id="485fa-370">**ASP.NET Core Module Log:** Log file not created</span></span>

<span data-ttu-id="485fa-371">Risoluzione dei problemi:</span><span class="sxs-lookup"><span data-stu-id="485fa-371">Troubleshooting:</span></span>

* <span data-ttu-id="485fa-372">Confermare che si usa l'endpoint URI corretto per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="485fa-372">Confirm you are using the correct URI endpoint for the application.</span></span> <span data-ttu-id="485fa-373">Controllare le associazioni.</span><span class="sxs-lookup"><span data-stu-id="485fa-373">Check your bindings.</span></span>

* <span data-ttu-id="485fa-374">Confermare che il sito Web IIS non si trovi nello stato *In arresto*.</span><span class="sxs-lookup"><span data-stu-id="485fa-374">Confirm that the IIS website is not in the *Stopped* state.</span></span>

### <a name="corewebengine-or-w3svc-server-features-disabled"></a><span data-ttu-id="485fa-375">Le funzionalità del server CoreWebEngine o W3SVC sono disabilitate</span><span class="sxs-lookup"><span data-stu-id="485fa-375">CoreWebEngine or W3SVC server features disabled</span></span>

* <span data-ttu-id="485fa-376">**Eccezione del sistema operativo:** per usare il modulo di ASP.NET Core è necessario installare le funzionalità di IIS 7.0 CoreWebEngine e W3SVC.</span><span class="sxs-lookup"><span data-stu-id="485fa-376">**OS Exception:** The IIS 7.0 CoreWebEngine and W3SVC features must be installed to use the ASP.NET Core Module.</span></span>

<span data-ttu-id="485fa-377">Risoluzione dei problemi:</span><span class="sxs-lookup"><span data-stu-id="485fa-377">Troubleshooting:</span></span>

* <span data-ttu-id="485fa-378">Confermare che siano state abilitati il ruolo e le funzionalità appropriate.</span><span class="sxs-lookup"><span data-stu-id="485fa-378">Confirm that you have enabled the proper role and features.</span></span> <span data-ttu-id="485fa-379">Vedere [Configurazione di IIS](#iis-configuration).</span><span class="sxs-lookup"><span data-stu-id="485fa-379">See [IIS Configuration](#iis-configuration).</span></span>

### <a name="incorrect-website-physical-path-or-application-missing"></a><span data-ttu-id="485fa-380">Percorso fisico del sito Web non corretto o applicazione mancante</span><span class="sxs-lookup"><span data-stu-id="485fa-380">Incorrect website physical path or application missing</span></span>

* <span data-ttu-id="485fa-381">**Browser:** 403 Non consentito: accesso negato **- OPPURE -** 403.14 Non consentito - Il server Web è configurato per non visualizzare il contenuto di questa directory.</span><span class="sxs-lookup"><span data-stu-id="485fa-381">**Browser:** 403 Forbidden - Access is denied **--OR--** 403.14 Forbidden - The Web server is configured to not list the contents of this directory.</span></span>

* <span data-ttu-id="485fa-382">**Registro dell'applicazione:** Nessuna voce</span><span class="sxs-lookup"><span data-stu-id="485fa-382">**Application Log:** No entry</span></span>

* <span data-ttu-id="485fa-383">**Registro del modulo di ASP.NET Core:** il file di registro non è stato creato</span><span class="sxs-lookup"><span data-stu-id="485fa-383">**ASP.NET Core Module Log:** Log file not created</span></span>

<span data-ttu-id="485fa-384">Risoluzione dei problemi:</span><span class="sxs-lookup"><span data-stu-id="485fa-384">Troubleshooting:</span></span>

* <span data-ttu-id="485fa-385">Controllare il sito Web IIS **Impostazioni di base** e la cartella dell'applicazione fisica.</span><span class="sxs-lookup"><span data-stu-id="485fa-385">Check the IIS website **Basic Settings** and the physical application folder.</span></span> <span data-ttu-id="485fa-386">Confermare che l'applicazione si trovi nella cartella nel sito Web IIS **Percorso fisico**.</span><span class="sxs-lookup"><span data-stu-id="485fa-386">Confirm that the application is in the folder at the IIS website **Physical path**.</span></span>

### <a name="incorrect-role-module-not-installed-or-incorrect-permissions"></a><span data-ttu-id="485fa-387">Ruolo non corretto, modulo non installato o autorizzazioni non corrette</span><span class="sxs-lookup"><span data-stu-id="485fa-387">Incorrect role, module not installed, or incorrect permissions</span></span>

* <span data-ttu-id="485fa-388">**Browser:** 500.19 Errore interno al server – non è possibile accedere alla pagina richiesta perché i dati di configurazione per la pagina non sono validi.</span><span class="sxs-lookup"><span data-stu-id="485fa-388">**Browser:** 500.19 Internal Server Error - The requested page cannot be accessed because the related configuration data for the page is invalid.</span></span>

* <span data-ttu-id="485fa-389">**Registro dell'applicazione:** Nessuna voce</span><span class="sxs-lookup"><span data-stu-id="485fa-389">**Application Log:** No entry</span></span>

* <span data-ttu-id="485fa-390">**Registro del modulo di ASP.NET Core:** il file di registro non è stato creato</span><span class="sxs-lookup"><span data-stu-id="485fa-390">**ASP.NET Core Module Log:** Log file not created</span></span>

<span data-ttu-id="485fa-391">Risoluzione dei problemi:</span><span class="sxs-lookup"><span data-stu-id="485fa-391">Troubleshooting:</span></span>

* <span data-ttu-id="485fa-392">Verificare di aver abilitato il ruolo appropriato.</span><span class="sxs-lookup"><span data-stu-id="485fa-392">Confirm that you've enabled the proper role.</span></span> <span data-ttu-id="485fa-393">Vedere [Configurazione di IIS](#iis-configuration).</span><span class="sxs-lookup"><span data-stu-id="485fa-393">See [IIS Configuration](#iis-configuration).</span></span>

* <span data-ttu-id="485fa-394">Controllare **Programmi &amp; Funzionalità** e confermare che il **Modulo di Microsoft ASP.NET Core** sia stato installato.</span><span class="sxs-lookup"><span data-stu-id="485fa-394">Check **Programs &amp; Features** and confirm that the **Microsoft ASP.NET Core Module** has been installed.</span></span> <span data-ttu-id="485fa-395">Se il **modulo Microsoft ASP.NET Core** non è presente nell'elenco dei programmi installati, installare il modulo.</span><span class="sxs-lookup"><span data-stu-id="485fa-395">If the **Microsoft ASP.NET Core Module** isn't present in the list of installed programs, install the module.</span></span> <span data-ttu-id="485fa-396">Vedere [Installare l'aggregazione di Hosting di.NET Core Windows Server](#install-the-net-core-windows-server-hosting-bundle).</span><span class="sxs-lookup"><span data-stu-id="485fa-396">See [Install the .NET Core Windows Server Hosting bundle](#install-the-net-core-windows-server-hosting-bundle).</span></span>

* <span data-ttu-id="485fa-397">Assicurarsi che **Pool di applicazioni** > **Modello di processo** > **Identità** sia impostato su **ApplicationPoolIdentity** o che l'identità personalizzata disponga delle autorizzazioni appropriate per accedere alla cartella di distribuzione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="485fa-397">Make sure that the **Application Pool** > **Process Model** > **Identity** is set to **ApplicationPoolIdentity** or your custom identity has the correct permissions to access the app's deployment folder.</span></span>

### <a name="incorrect-processpath-missing-path-variable-hosting-bundle-not-installed-systemiis-not-restarted-vc-redistributable-not-installed-or-dotnetexe-access-violation"></a><span data-ttu-id="485fa-398">ProcessPath non corretto, variabile di percorso mancante, aggregazione di hosting non installata, sistema/IIS non riavviato, VC Redistributable non installato o violazione dell'accesso a dotnet.exe</span><span class="sxs-lookup"><span data-stu-id="485fa-398">Incorrect processPath, missing PATH variable, hosting bundle not installed, system/IIS not restarted, VC++ Redistributable not installed, or dotnet.exe access violation</span></span>

* <span data-ttu-id="485fa-399">**Browser:** errore HTTP 502.5 - errore del processo</span><span class="sxs-lookup"><span data-stu-id="485fa-399">**Browser:** HTTP Error 502.5 - Process Failure</span></span>

* <span data-ttu-id="485fa-400">**Registro dell'applicazione:** l'applicazione "MACHINE/WEBROOT/APPHOST/MY_APPLICATION" con radice fisica "C:\\PATH}\' Impossibile avviare il processo con la riga di comando"".\my_application.exe" ", ErrorCode = "0x80070002 : 0.</span><span class="sxs-lookup"><span data-stu-id="485fa-400">**Application Log:** Application 'MACHINE/WEBROOT/APPHOST/MY_APPLICATION' with physical root 'C:\\{PATH}\' failed to start process with commandline '".\my_application.exe" ', ErrorCode = '0x80070002 : 0.</span></span>

* <span data-ttu-id="485fa-401">**Registro del modulo di ASP.NET Core:** il file di registro è stato creato ma è vuoto</span><span class="sxs-lookup"><span data-stu-id="485fa-401">**ASP.NET Core Module Log:** Log file created but empty</span></span>

<span data-ttu-id="485fa-402">Risoluzione dei problemi:</span><span class="sxs-lookup"><span data-stu-id="485fa-402">Troubleshooting:</span></span>

* <span data-ttu-id="485fa-403">Confermare che l'applicazione venga eseguita in locale su Kestrel.</span><span class="sxs-lookup"><span data-stu-id="485fa-403">Confirm that the application runs locally on Kestrel.</span></span> <span data-ttu-id="485fa-404">Un errore del processo può essere il risultato di un problema all'interno dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="485fa-404">A process failure might be the result of a problem within the application.</span></span> <span data-ttu-id="485fa-405">Per altre informazioni, vedere [Consigli per la risoluzione dei problemi](#troubleshooting-tips).</span><span class="sxs-lookup"><span data-stu-id="485fa-405">For more information, see [Troubleshooting tips](#troubleshooting-tips).</span></span>

* <span data-ttu-id="485fa-406">Verificare che l'attributo *processPath* dell'elemento `<aspNetCore>` in *web.config* sia *dotnet* per una distribuzione dipendente da framework (FDD) o *.\my_application.exe* per una distribuzione indipendente (SCD, Self-Contained Deployment).</span><span class="sxs-lookup"><span data-stu-id="485fa-406">Check the *processPath* attribute on the `<aspNetCore>` element in *web.config* to confirm that it's *dotnet* for a framework-dependent deployment (FDD) or *.\my_application.exe* for a self-contained deployment (SCD).</span></span>

* <span data-ttu-id="485fa-407">Per una distribuzione dipendente dal framework, *dotnet.exe* potrebbe non essere accessibile tramite le impostazioni del percorso.</span><span class="sxs-lookup"><span data-stu-id="485fa-407">For an FDD, *dotnet.exe* might not be accessible via the PATH settings.</span></span> <span data-ttu-id="485fa-408">Confermare che *C:\Program Files\dotnet\* esiste nelle impostazioni del percorso di sistema.</span><span class="sxs-lookup"><span data-stu-id="485fa-408">Confirm that *C:\Program Files\dotnet\* exists in the System PATH settings.</span></span>

* <span data-ttu-id="485fa-409">Per una distribuzione dipendente da framework, *dotnet.exe* potrebbe non essere accessibile per l'identità utente del pool di applicazioni.</span><span class="sxs-lookup"><span data-stu-id="485fa-409">For an FDD, *dotnet.exe* might not be accessible for the user identity of the Application Pool.</span></span> <span data-ttu-id="485fa-410">Confermare che l'identità dell'utente di AppPool disponga dell'accesso alla directory *C:\Program Files\dotnet*.</span><span class="sxs-lookup"><span data-stu-id="485fa-410">Confirm that the AppPool user identity has access to the *C:\Program Files\dotnet* directory.</span></span> <span data-ttu-id="485fa-411">Verificare che non siano presenti regole di negazione configurate per l'identità dell'utente di AppPool in *C:\Program Files\dotnet* e nelle directory dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="485fa-411">Confirm that there are no deny rules configured for the AppPool user identity on the *C:\Program Files\dotnet* and application directories.</span></span>

* <span data-ttu-id="485fa-412">È possibile che sia stata eseguita una distribuzione FDD e che sia stato installato .NET Core senza riavviare IIS.</span><span class="sxs-lookup"><span data-stu-id="485fa-412">You may have deployed an FDD and installed .NET Core without restarting IIS.</span></span> <span data-ttu-id="485fa-413">Riavviare il server o riavviare IIS eseguendo **net stop was /y** seguito da **net start w3svc** da un prompt dei comandi.</span><span class="sxs-lookup"><span data-stu-id="485fa-413">Either restart the server or restart IIS by executing **net stop was /y** followed by **net start w3svc** from a command prompt.</span></span>

* <span data-ttu-id="485fa-414">È possibile che sia stata eseguita una distribuzione FDD senza installare il runtime nel sistema host.</span><span class="sxs-lookup"><span data-stu-id="485fa-414">You may have deployed an FDD without installing the .NET Core runtime on the hosting system.</span></span> <span data-ttu-id="485fa-415">Se si prova a eseguire una distribuzione FDD ma non è stato installato il runtime .NET Core, eseguire il **programma di installazione dell'aggregazione di hosting di .NET Core Windows Server** nel sistema.</span><span class="sxs-lookup"><span data-stu-id="485fa-415">If you're attempting to deploy a FDD and haven't installed the .NET Core runtime, run the **.NET Core Windows Server Hosting bundle installer** on the system.</span></span> <span data-ttu-id="485fa-416">Vedere [Installare l'aggregazione di Hosting di.NET Core Windows Server](#install-the-net-core-windows-server-hosting-bundle).</span><span class="sxs-lookup"><span data-stu-id="485fa-416">See [Install the .NET Core Windows Server Hosting bundle](#install-the-net-core-windows-server-hosting-bundle).</span></span> <span data-ttu-id="485fa-417">Se si prova a installare il runtime .NET Core in un sistema senza connessione a Internet, ottenere il runtime nei [download .NET](https://www.microsoft.com/net/download/core) ed eseguire il programma di installazione dell'aggregazione di hosting per installare il modulo ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="485fa-417">If you're attempting to install the .NET Core runtime on a system without an Internet connection, obtain the runtime from [.NET Downloads](https://www.microsoft.com/net/download/core) and run the hosting bundle installer to install the ASP.NET Core Module.</span></span> <span data-ttu-id="485fa-418">Completare l'installazione riavviando il sistema o riavviando IIS eseguendo **net stop was /y** seguito da **net start w3svc** da un prompt dei comandi.</span><span class="sxs-lookup"><span data-stu-id="485fa-418">Complete the installation by restarting the system or restarting IIS by executing **net stop was /y** followed by **net start w3svc** from a command prompt.</span></span>

* <span data-ttu-id="485fa-419">È possibile che sia stata eseguita una distribuzione FDD e che sia stato installato .NET Core senza riavviare il sistema/IIS.</span><span class="sxs-lookup"><span data-stu-id="485fa-419">You may have deployed an FDD and installed .NET Core without restarting the system/IIS.</span></span> <span data-ttu-id="485fa-420">Riavviare il sistema o riavviare IIS eseguendo **net stop was /y** seguito da **net start w3svc** da un prompt dei comandi.</span><span class="sxs-lookup"><span data-stu-id="485fa-420">Either restart the system or restart IIS by executing **net stop was /y** followed by **net start w3svc** from a command prompt.</span></span>

* <span data-ttu-id="485fa-421">È possibile che sia stata eseguita una distribuzione FDD e che *Microsoft Visual C++ 2015 Redistributable (x64)* non sia installato nel sistema.</span><span class="sxs-lookup"><span data-stu-id="485fa-421">You may have deployed an FDD and the *Microsoft Visual C++ 2015 Redistributable (x64)* is not installed on the system.</span></span> <span data-ttu-id="485fa-422">È possibile ottenere un programma di installazione da [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=53840).</span><span class="sxs-lookup"><span data-stu-id="485fa-422">You may obtain an installer from the [Microsoft Download Center](https://www.microsoft.com/download/details.aspx?id=53840).</span></span>

### <a name="incorrect-arguments-of-aspnetcore-element"></a><span data-ttu-id="485fa-423">Argomenti non corretti dell'elemento \<aspNetCore\></span><span class="sxs-lookup"><span data-stu-id="485fa-423">Incorrect arguments of \<aspNetCore\> element</span></span>

* <span data-ttu-id="485fa-424">**Browser:** errore HTTP 502.5 - errore del processo</span><span class="sxs-lookup"><span data-stu-id="485fa-424">**Browser:** HTTP Error 502.5 - Process Failure</span></span>

* <span data-ttu-id="485fa-425">**Registro dell'applicazione:** l'applicazione "MACHINE/WEBROOT/APPHOST/MY_APPLICATION" con radice fisica "C:\\PATH}\' Impossibile avviare il processo con la riga di comando'"dotnet\my_application.dll", ErrorCode = "0x80004005 : 80008081.</span><span class="sxs-lookup"><span data-stu-id="485fa-425">**Application Log:** Application 'MACHINE/WEBROOT/APPHOST/MY_APPLICATION' with physical root 'C:\\{PATH}\' failed to start process with commandline '"dotnet" .\my_application.dll', ErrorCode = '0x80004005 : 80008081.</span></span>

* <span data-ttu-id="485fa-426">**Registro di modulo di ASP.NET Core:** l'esecuzione dell'applicazione non esiste: "PATH\my_application.dll"</span><span class="sxs-lookup"><span data-stu-id="485fa-426">**ASP.NET Core Module Log:** The application to execute does not exist: 'PATH\my_application.dll'</span></span>

<span data-ttu-id="485fa-427">Risoluzione dei problemi:</span><span class="sxs-lookup"><span data-stu-id="485fa-427">Troubleshooting:</span></span>

* <span data-ttu-id="485fa-428">Confermare che l'applicazione venga eseguita in locale su Kestrel.</span><span class="sxs-lookup"><span data-stu-id="485fa-428">Confirm that the application runs locally on Kestrel.</span></span> <span data-ttu-id="485fa-429">Un errore del processo può essere il risultato di un problema all'interno dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="485fa-429">A process failure might be the result of a problem within the application.</span></span> <span data-ttu-id="485fa-430">Per altre informazioni, vedere [Consigli per la risoluzione dei problemi](#troubleshooting-tips).</span><span class="sxs-lookup"><span data-stu-id="485fa-430">For more information, see [Troubleshooting tips](#troubleshooting-tips).</span></span>

* <span data-ttu-id="485fa-431">Verificare che l'attributo *arguments* dell'elemento `<aspNetCore>` in *web.config* sia (a) *.\my_application.dll* per una distribuzione dipendente da framework (FDD) o (b) non disponibile, una stringa vuota (*arguments=""*) o un elenco degli argomenti dell'app (*arguments="arg1, arg2, ..."*) per una distribuzione indipendente (SCD).</span><span class="sxs-lookup"><span data-stu-id="485fa-431">Examine the *arguments* attribute on the `<aspNetCore>` element in *web.config* to confirm that it is either (a) *.\my_application.dll* for a framework-dependent deployment (FDD); or (b) not present, an empty string (*arguments=""*), or a list of your app's arguments (*arguments="arg1, arg2, ..."*) for a self-contained deployment (SCD).</span></span>

### <a name="missing-net-framework-version"></a><span data-ttu-id="485fa-432">Versione di .NET Framework non presente</span><span class="sxs-lookup"><span data-stu-id="485fa-432">Missing .NET Framework version</span></span>

* <span data-ttu-id="485fa-433">**Browser:** 502.3 Gateway non valido - si è verificato un errore di connessione durante il tentativo di routing della richiesta.</span><span class="sxs-lookup"><span data-stu-id="485fa-433">**Browser:** 502.3 Bad Gateway - There was a connection error while trying to route the request.</span></span>

* <span data-ttu-id="485fa-434">**Registro dell'applicazione:** ErrorCode = l'applicazione "MACHINE/WEBROOT/APPHOST/MY_APPLICATION" con radice fisica "C:\\PATH}\' Impossibile avviare il processo con la riga di comando""dotnet\my_application.dll", ErrorCode = "0x80004005 : 80008081.</span><span class="sxs-lookup"><span data-stu-id="485fa-434">**Application Log:** ErrorCode = Application 'MACHINE/WEBROOT/APPHOST/MY_APPLICATION' with physical root 'C:\\{PATH}\' failed to start process with commandline '"dotnet" .\my_application.dll', ErrorCode = '0x80004005 : 80008081.</span></span>

* <span data-ttu-id="485fa-435">**Registro di modulo di ASP.NET Core:** Metodo, file o eccezione dell'assembly mancanti.</span><span class="sxs-lookup"><span data-stu-id="485fa-435">**ASP.NET Core Module Log:** Missing method, file, or assembly exception.</span></span> <span data-ttu-id="485fa-436">Il metodo, il file o l'assembly specificati nell'eccezione sono un metodo, un file o un'assembly .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="485fa-436">The method, file, or assembly specified in the exception is a .NET Framework method, file, or assembly.</span></span>

<span data-ttu-id="485fa-437">Risoluzione dei problemi:</span><span class="sxs-lookup"><span data-stu-id="485fa-437">Troubleshooting:</span></span>

* <span data-ttu-id="485fa-438">Installare la versione di .NET Framework mancante dal sistema.</span><span class="sxs-lookup"><span data-stu-id="485fa-438">Install the .NET Framework version missing from the system.</span></span>

* <span data-ttu-id="485fa-439">Per una distribuzione dipendente da framework (FDD) , verificare che nel sistema sia installato il runtime corretto.</span><span class="sxs-lookup"><span data-stu-id="485fa-439">For a framework-dependent deployment (FDD), confirm that you have the correct runtime installed on the system.</span></span> <span data-ttu-id="485fa-440">Se quando si aggiorna un progetto da 1.1 a 2.0 e si distribuisce il sistema host si riceve questa eccezione, installare il framework 2.0 nel sistema host.</span><span class="sxs-lookup"><span data-stu-id="485fa-440">If you upgrade a project from 1.1 to 2.0, deploy to the hosting system, and receive this exception, ensure you install the 2.0 framework on the hosting system.</span></span>

### <a name="stopped-application-pool"></a><span data-ttu-id="485fa-441">Pool di applicazioni arrestato</span><span class="sxs-lookup"><span data-stu-id="485fa-441">Stopped Application Pool</span></span>

* <span data-ttu-id="485fa-442">**Browser:** 503 Servizio non disponibile</span><span class="sxs-lookup"><span data-stu-id="485fa-442">**Browser:** 503 Service Unavailable</span></span>

* <span data-ttu-id="485fa-443">**Registro dell'applicazione:** Nessuna voce</span><span class="sxs-lookup"><span data-stu-id="485fa-443">**Application Log:** No entry</span></span>

* <span data-ttu-id="485fa-444">**Registro del modulo di ASP.NET Core:** il file di registro non è stato creato</span><span class="sxs-lookup"><span data-stu-id="485fa-444">**ASP.NET Core Module Log:** Log file not created</span></span>

<span data-ttu-id="485fa-445">Risoluzione dei problemi</span><span class="sxs-lookup"><span data-stu-id="485fa-445">Troubleshooting</span></span>

* <span data-ttu-id="485fa-446">Confermare che il pool di applicazioni non si trovi nello stato *In arresto*.</span><span class="sxs-lookup"><span data-stu-id="485fa-446">Confirm that the Application Pool is not in the *Stopped* state.</span></span>

### <a name="iis-integration-middleware-not-implemented"></a><span data-ttu-id="485fa-447">Middleware di integrazione di IIS non implementato</span><span class="sxs-lookup"><span data-stu-id="485fa-447">IIS Integration middleware not implemented</span></span>

* <span data-ttu-id="485fa-448">**Browser:** errore HTTP 502.5 - errore del processo</span><span class="sxs-lookup"><span data-stu-id="485fa-448">**Browser:** HTTP Error 502.5 - Process Failure</span></span>

* <span data-ttu-id="485fa-449">**Registro dell'applicazione:** l'applicazione "MACHINE/WEBROOT/APPHOST/MY_APPLICATION" con radice fisica "C:\\{PATH}\' ha creato un processo con la riga di comando" "C:\\{PATH}\my_application.{exe|dll}" ma ha danneggiato o non ha risposto o non è stata in ascolto sulla porta specificata "{PORT}", ErrorCode = "0x800705b4"</span><span class="sxs-lookup"><span data-stu-id="485fa-449">**Application Log:** Application 'MACHINE/WEBROOT/APPHOST/MY_APPLICATION' with physical root 'C:\\{PATH}\' created process with commandline '"C:\\{PATH}\my_application.{exe|dll}" ' but either crashed or did not reponse or did not listen on the given port '{PORT}', ErrorCode = '0x800705b4'</span></span>

* <span data-ttu-id="485fa-450">**Registro di modulo di ASP.NET Core:** Il file di registro ha creato e mostra il normale funzionamento.</span><span class="sxs-lookup"><span data-stu-id="485fa-450">**ASP.NET Core Module Log:** Log file created and shows normal operation.</span></span>

<span data-ttu-id="485fa-451">Risoluzione dei problemi</span><span class="sxs-lookup"><span data-stu-id="485fa-451">Troubleshooting</span></span>

* <span data-ttu-id="485fa-452">Confermare che l'app sia eseguita in locale su Kestrel.</span><span class="sxs-lookup"><span data-stu-id="485fa-452">Confirm that the app runs locally on Kestrel.</span></span> <span data-ttu-id="485fa-453">Un errore del processo può essere causato da un problema interno dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="485fa-453">A process failure might be the result of a problem within the app.</span></span> <span data-ttu-id="485fa-454">Per altre informazioni, vedere [Consigli per la risoluzione dei problemi](#troubleshooting-tips).</span><span class="sxs-lookup"><span data-stu-id="485fa-454">For more information, see [Troubleshooting tips](#troubleshooting-tips).</span></span>

* <span data-ttu-id="485fa-455">Verificare che sia stato creato correttamente il riferimento al middleware di integrazione IIS chiamando il metodo *.UseIISIntegration()* su *WebHostBuilder()* dell'applicazione (ASP.NET Core 1.x) o usando il metodo `CreateDefaultBuilder` (ASP.NET Core 2.x).</span><span class="sxs-lookup"><span data-stu-id="485fa-455">Confirm that you've correctly referenced the IIS Integration middleware by calling the *.UseIISIntegration()* method on the application's *WebHostBuilder()* (ASP.NET Core 1.x) or used the `CreateDefaultBuilder` method (ASP.NET Core 2.x).</span></span> <span data-ttu-id="485fa-456">Per informazioni dettagliate, vedere [Hosting in ASP.NET Core](xref:fundamentals/hosting).</span><span class="sxs-lookup"><span data-stu-id="485fa-456">See [Hosting in ASP.NET Core](xref:fundamentals/hosting) for details.</span></span>

### <a name="sub-application-includes-a-handlers-section"></a><span data-ttu-id="485fa-457">La sotto-applicazione include una sezione \<gestori\></span><span class="sxs-lookup"><span data-stu-id="485fa-457">Sub-application includes a \<handlers\> section</span></span>

* <span data-ttu-id="485fa-458">**Browser:** errore HTTP 500.19 - errore del server interno</span><span class="sxs-lookup"><span data-stu-id="485fa-458">**Browser:** HTTP Error 500.19 - Internal Server Error</span></span>

* <span data-ttu-id="485fa-459">**Registro dell'applicazione:** Nessuna voce</span><span class="sxs-lookup"><span data-stu-id="485fa-459">**Application Log:** No entry</span></span>

* <span data-ttu-id="485fa-460">**Registro di modulo di ASP.NET Core:** Il file di registro ha creato e mostra il normale funzionamento per l'applicazione della radice.</span><span class="sxs-lookup"><span data-stu-id="485fa-460">**ASP.NET Core Module Log:** Log file created and shows normal operation for the root application.</span></span> <span data-ttu-id="485fa-461">Il file di registro non è stato creato per la sotto-applicazione.</span><span class="sxs-lookup"><span data-stu-id="485fa-461">Log file not created for the sub-application.</span></span>

<span data-ttu-id="485fa-462">Risoluzione dei problemi</span><span class="sxs-lookup"><span data-stu-id="485fa-462">Troubleshooting</span></span>

* <span data-ttu-id="485fa-463">Verificare che il file *web.config* della sotto-applicazione non includa una sezione `<handlers>`.</span><span class="sxs-lookup"><span data-stu-id="485fa-463">Confirm that the sub-app's *web.config* file doesn't include a `<handlers>` section.</span></span>

### <a name="application-configuration-general-issue"></a><span data-ttu-id="485fa-464">Problema generale della configurazione dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="485fa-464">Application configuration general issue</span></span>

* <span data-ttu-id="485fa-465">**Browser:** errore HTTP 502.5 - errore del processo</span><span class="sxs-lookup"><span data-stu-id="485fa-465">**Browser:** HTTP Error 502.5 - Process Failure</span></span>

* <span data-ttu-id="485fa-466">**Registro dell'applicazione:** l'applicazione "MACHINE/WEBROOT/APPHOST/MY_APPLICATION" con radice fisica "C:\\{PATH}\' ha creato un processo con la riga di comando" "C:\\{PATH}\my_application.{exe|dll}" ma ha danneggiato o non ha risposto o non è stata in ascolto sulla porta specificata "{PORT}", ErrorCode = "0x800705b4"</span><span class="sxs-lookup"><span data-stu-id="485fa-466">**Application Log:** Application 'MACHINE/WEBROOT/APPHOST/MY_APPLICATION' with physical root 'C:\\{PATH}\' created process with commandline '"C:\\{PATH}\my_application.{exe|dll}" ' but either crashed or did not reponse or did not listen on the given port '{PORT}', ErrorCode = '0x800705b4'</span></span>

* <span data-ttu-id="485fa-467">**Registro del modulo di ASP.NET Core:** il file di registro è stato creato ma è vuoto</span><span class="sxs-lookup"><span data-stu-id="485fa-467">**ASP.NET Core Module Log:** Log file created but empty</span></span>

<span data-ttu-id="485fa-468">Risoluzione dei problemi</span><span class="sxs-lookup"><span data-stu-id="485fa-468">Troubleshooting</span></span>

* <span data-ttu-id="485fa-469">Questa eccezione generale indica che non è stato possibile avviare il processo, probabilmente a causa di un problema di configurazione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="485fa-469">This general exception indicates that the process failed to start, most likely due to an application configuration issue.</span></span> <span data-ttu-id="485fa-470">Facendo riferimento alla [struttura directory](xref:hosting/directory-structure), verificare che le cartelle e i file distribuiti dell'app siano corretti e che i file di configurazione dell'app siano presenti e contengano le impostazioni corrette per l'app e l'ambiente.</span><span class="sxs-lookup"><span data-stu-id="485fa-470">Referring to [Directory Structure](xref:hosting/directory-structure), confirm that your app's deployed files and folders are appropriate and that your app's configuration files are present and contain the correct settings for your app and environment.</span></span> <span data-ttu-id="485fa-471">Per altre informazioni, vedere [Consigli per la risoluzione dei problemi](#troubleshooting-tips).</span><span class="sxs-lookup"><span data-stu-id="485fa-471">For more information, see [Troubleshooting tips](#troubleshooting-tips).</span></span>

## <a name="resources"></a><span data-ttu-id="485fa-472">Risorse</span><span class="sxs-lookup"><span data-stu-id="485fa-472">Resources</span></span>

* [<span data-ttu-id="485fa-473">Introduzione al modulo di ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="485fa-473">Introduction to ASP.NET Core Module</span></span>](xref:fundamentals/servers/aspnet-core-module)
* [<span data-ttu-id="485fa-474">Guida di riferimento per la configurazione del modulo ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="485fa-474">ASP.NET Core Module configuration reference</span></span>](xref:hosting/aspnet-core-module)
* [<span data-ttu-id="485fa-475">Utilizzo dei moduli IIS con ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="485fa-475">Using IIS Modules with ASP.NET Core</span></span>](xref:hosting/iis-modules)
* [<span data-ttu-id="485fa-476">Introduzione a ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="485fa-476">Introduction to ASP.NET Core</span></span>](../index.md)
* [<span data-ttu-id="485fa-477">Il sito IIS ufficiale di Microsoft</span><span class="sxs-lookup"><span data-stu-id="485fa-477">The Official Microsoft IIS Site</span></span>](https://www.iis.net/)
* [<span data-ttu-id="485fa-478">Libreria di Microsoft TechNet: Windows Server</span><span class="sxs-lookup"><span data-stu-id="485fa-478">Microsoft TechNet Library: Windows Server</span></span>](https://docs.microsoft.com/windows-server/windows-server-versions)
