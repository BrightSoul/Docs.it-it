---
title: Convalida del modello in ASP.NET MVC di base
author: rachelappel
description: Informazioni sulla convalida del modello in ASP.NET MVC di base.
keywords: Convalida di ASP.NET Core, MVC,
ms.author: riande
manager: wpickett
ms.date: 10/14/2016
ms.topic: article
ms.assetid: 3a8676dd-7ed8-4a05-bca2-44e288ab99ee
ms.technology: aspnet
ms.prod: asp.net-core
uid: mvc/models/validation
ms.custom: H1Hack27Feb2017
ms.openlocfilehash: efbc68e898cadd06d61fa69914fe08f3a12ba802
ms.sourcegitcommit: 8b5733f1cd5d2c2b6d432bf82fcd4be2d2d6b2a3
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/28/2017
---
# <a name="introduction-to-model-validation-in-aspnet-core-mvc"></a><span data-ttu-id="ee3a7-104">Introduzione alla convalida del modello in ASP.NET MVC di base</span><span class="sxs-lookup"><span data-stu-id="ee3a7-104">Introduction to model validation in ASP.NET Core MVC</span></span>

<span data-ttu-id="ee3a7-105">Da [Rachel Appel](https://github.com/rachelappel)</span><span class="sxs-lookup"><span data-stu-id="ee3a7-105">By [Rachel Appel](https://github.com/rachelappel)</span></span>

## <a name="introduction-to-model-validation"></a><span data-ttu-id="ee3a7-106">Introduzione alla convalida del modello</span><span class="sxs-lookup"><span data-stu-id="ee3a7-106">Introduction to model validation</span></span>

<span data-ttu-id="ee3a7-107">Prima di un'app archivia i dati in un database, l'applicazione deve convalidare i dati.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-107">Before an app stores data in a database, the app must validate the data.</span></span> <span data-ttu-id="ee3a7-108">Dati devono essere verificati potenziali minacce alla sicurezza, verificate che viene formattato in modo appropriato per tipo e dimensione, e deve essere conforme alle regole.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-108">Data must be checked for potential security threats, verified that it is appropriately formatted by type and size, and it must conform to your rules.</span></span> <span data-ttu-id="ee3a7-109">Sebbene possa essere ridondante e difficile da implementare, è necessaria la convalida.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-109">Validation is necessary although it can be redundant and tedious to implement.</span></span> <span data-ttu-id="ee3a7-110">In MVC, la convalida viene eseguita nel client e server.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-110">In MVC, validation happens on both the client and server.</span></span>

<span data-ttu-id="ee3a7-111">Fortunatamente, .NET è astratto convalida in attributi di convalida.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-111">Fortunately, .NET has abstracted validation into validation attributes.</span></span> <span data-ttu-id="ee3a7-112">Questi attributi contengono codice di convalida, riducendo la quantità di codice da scrivere.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-112">These attributes contain validation code, thereby reducing the amount of code you must write.</span></span>

<span data-ttu-id="ee3a7-113">[Consente di visualizzare o scaricare l'esempio da GitHub](https://github.com/aspnet/Docs/tree/master/aspnetcore/mvc/models/validation/sample).</span><span class="sxs-lookup"><span data-stu-id="ee3a7-113">[View or download sample from GitHub](https://github.com/aspnet/Docs/tree/master/aspnetcore/mvc/models/validation/sample).</span></span>

## <a name="validation-attributes"></a><span data-ttu-id="ee3a7-114">Attributi di convalida</span><span class="sxs-lookup"><span data-stu-id="ee3a7-114">Validation Attributes</span></span>

<span data-ttu-id="ee3a7-115">Gli attributi di convalida sono un modo per configurare la convalida del modello in modo simile a livello concettuale convalida nei campi nelle tabelle di database.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-115">Validation attributes are a way to configure model validation so it's similar conceptually to validation on fields in database tables.</span></span> <span data-ttu-id="ee3a7-116">Sono inclusi i vincoli, ad esempio l'assegnazione di tipi di dati o i campi obbligatori.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-116">This includes constraints such as assigning data types or required fields.</span></span> <span data-ttu-id="ee3a7-117">Altri tipi di convalida includono l'applicazione di modelli di dati per applicare le regole di business, ad esempio una carta di credito, il numero di telefono o un indirizzo di posta elettronica.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-117">Other types of validation include applying patterns to data to enforce business rules, such as a credit card, phone number, or email address.</span></span> <span data-ttu-id="ee3a7-118">Gli attributi di convalida assicurarsi di applicare questi requisiti molto più semplici e facile da utilizzare.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-118">Validation attributes make enforcing these requirements much simpler and easier to use.</span></span>

<span data-ttu-id="ee3a7-119">Di seguito è riportato un annotazioni `Movie` modello da un'app archivia informazioni sui film e programmi TV.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-119">Below is an annotated `Movie` model from an app that stores information about movies and TV shows.</span></span> <span data-ttu-id="ee3a7-120">La maggior parte delle proprietà sono necessario e diverse proprietà di stringa sono i requisiti di lunghezza.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-120">Most of the properties are required and several string properties have length requirements.</span></span> <span data-ttu-id="ee3a7-121">Inoltre, non c'è una restrizione di intervallo numerico in atto per la `Price` proprietà da 0 a $999,99, insieme a un attributo di convalida personalizzata.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-121">Additionally, there is a numeric range restriction in place for the `Price` property from 0 to $999.99, along with a custom validation attribute.</span></span>

[!code-csharp[Main](validation/sample/Movie.cs?range=6-29)]

<span data-ttu-id="ee3a7-122">Semplicemente leggendo il modello vengono visualizzate le regole relative ai dati per questa app, semplificando la gestione del codice.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-122">Simply reading through the model reveals the rules about data for this app, making it easier to maintain the code.</span></span> <span data-ttu-id="ee3a7-123">Di seguito sono diversi attributi di convalida incorporate comuni:</span><span class="sxs-lookup"><span data-stu-id="ee3a7-123">Below are several popular built-in validation attributes:</span></span>

* <span data-ttu-id="ee3a7-124">`[CreditCard]`: Consente di convalidare la proprietà ha un formato di carta di credito.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-124">`[CreditCard]`: Validates the property has a credit card format.</span></span>

* <span data-ttu-id="ee3a7-125">`[Compare]`: Convalida due proprietà in una corrispondenza del modello.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-125">`[Compare]`: Validates two properties in a model match.</span></span>

* <span data-ttu-id="ee3a7-126">`[EmailAddress]`: Consente di convalidare la proprietà ha un formato di posta elettronica.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-126">`[EmailAddress]`: Validates the property has an email format.</span></span>

* <span data-ttu-id="ee3a7-127">`[Phone]`: Consente di convalidare la proprietà ha un formato telefonico.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-127">`[Phone]`: Validates the property has a telephone format.</span></span>

* <span data-ttu-id="ee3a7-128">`[Range]`: Consente di convalidare il valore di proprietà rientra l'intervallo specificato.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-128">`[Range]`: Validates the property value falls within the given range.</span></span>

* <span data-ttu-id="ee3a7-129">`[RegularExpression]`: Verifica che i dati corrispondano all'espressione regolare specificata.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-129">`[RegularExpression]`: Validates that the data matches the specified regular expression.</span></span>

* <span data-ttu-id="ee3a7-130">`[Required]`: Rende una proprietà necessaria.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-130">`[Required]`: Makes a property required.</span></span>

* <span data-ttu-id="ee3a7-131">`[StringLength]`: Consente di convalidare che una proprietà di stringa ha più la lunghezza massima specificata.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-131">`[StringLength]`: Validates that a string property has at most the given maximum length.</span></span>

* <span data-ttu-id="ee3a7-132">`[Url]`: Consente di convalidare la proprietà ha un formato di URL.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-132">`[Url]`: Validates the property has a URL format.</span></span>

<span data-ttu-id="ee3a7-133">MVC supporta qualsiasi attributo che deriva da `ValidationAttribute` ai fini della convalida.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-133">MVC supports any attribute that derives from `ValidationAttribute` for validation purposes.</span></span> <span data-ttu-id="ee3a7-134">Numero di attributi di convalida utile è reperibile nel [System.ComponentModel.DataAnnotations](https://docs.microsoft.com/dotnet/api/system.componentmodel.dataannotations) dello spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-134">Many useful validation attributes can be found in the [System.ComponentModel.DataAnnotations](https://docs.microsoft.com/dotnet/api/system.componentmodel.dataannotations) namespace.</span></span>

<span data-ttu-id="ee3a7-135">Potrebbero essere presenti istanze in cui è necessario più funzionalità rispetto a forniscono attributi predefiniti.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-135">There may be instances where you need more features than built-in attributes provide.</span></span> <span data-ttu-id="ee3a7-136">Tutte le volte, è possibile creare gli attributi di convalida personalizzata mediante derivazione da `ValidationAttribute` o la modifica del modello per implementare `IValidatableObject`.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-136">For those times, you can create custom validation attributes by deriving from `ValidationAttribute` or changing your model to implement `IValidatableObject`.</span></span>

## <a name="notes-on-the-use-of-the-required-attribute"></a><span data-ttu-id="ee3a7-137">Note sull'utilizzo dell'attributo obbligatorio</span><span class="sxs-lookup"><span data-stu-id="ee3a7-137">Notes on the use of the Required attribute</span></span>

<span data-ttu-id="ee3a7-138">Non nullable [i tipi di valore](/dotnet/csharp/language-reference/keywords/value-types) (ad esempio `decimal`, `int`, `float`, e `DateTime`) sono intrinsecamente necessari e non è necessaria la `Required` attributo.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-138">Non-nullable [value types](/dotnet/csharp/language-reference/keywords/value-types) (such as `decimal`, `int`, `float`, and `DateTime`) are inherently required and don't need the `Required` attribute.</span></span> <span data-ttu-id="ee3a7-139">L'applicazione non esegue alcun controllo di convalida sul lato server per i tipi non contrassegnati `Required`.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-139">The app performs no server-side validation checks for non-nullable types that are marked `Required`.</span></span>

<span data-ttu-id="ee3a7-140">Associazione di modelli MVC, che non è attualmente preoccupata per convalida e gli attributi di convalida, rifiuta l'invio di un campo di form che contiene un valore mancante o spazi vuoti per un tipo non nullable.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-140">MVC model binding, which isn't concerned with validation and validation attributes, rejects a form field submission containing a missing value or whitespace for a non-nullable type.</span></span> <span data-ttu-id="ee3a7-141">In assenza di un `BindRequired` attributo sulla proprietà di destinazione, l'associazione di modelli ignora i dati mancanti per i tipi che non ammette valori null, in cui il campo del form è assente da dati del form in ingresso.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-141">In the absence of a `BindRequired` attribute on the target property, model binding ignores missing data for non-nullable types, where the form field is absent from the incoming form data.</span></span>

<span data-ttu-id="ee3a7-142">Il [BindRequired attributo](/aspnet/core/api/microsoft.aspnetcore.mvc.modelbinding.bindrequiredattribute) (vedere anche [personalizzare il comportamento di associazione del modello con attributi](xref:mvc/models/model-binding#customize-model-binding-behavior-with-attributes)) è utile per verificare i dati del form sono stati completati.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-142">The [BindRequired attribute](/aspnet/core/api/microsoft.aspnetcore.mvc.modelbinding.bindrequiredattribute) (also see [Customize model binding behavior with attributes](xref:mvc/models/model-binding#customize-model-binding-behavior-with-attributes)) is useful to ensure form data is complete.</span></span> <span data-ttu-id="ee3a7-143">Se applicato a una proprietà, il sistema di associazione del modello richiede un valore per tale proprietà.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-143">When applied to a property, the model binding system requires a value for that property.</span></span> <span data-ttu-id="ee3a7-144">Quando applicato a un tipo, il sistema di associazione del modello richiede valori per tutte le proprietà di quel tipo.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-144">When applied to a type, the model binding system requires values for all of the properties of that type.</span></span>

<span data-ttu-id="ee3a7-145">Quando si utilizza un [Nullable\<T > tipo](/dotnet/csharp/programming-guide/nullable-types/) (ad esempio, `decimal?` o `System.Nullable<decimal>`) e contrassegnarla `Required`, viene eseguito un controllo di convalida sul lato server come se la proprietà fosse un tipo nullable standard (per l'esempio, un `string`).</span><span class="sxs-lookup"><span data-stu-id="ee3a7-145">When you use a [Nullable\<T> type](/dotnet/csharp/programming-guide/nullable-types/) (for example, `decimal?` or `System.Nullable<decimal>`) and mark it `Required`, a server-side validation check is performed as if the property were a standard nullable type (for example, a `string`).</span></span>

<span data-ttu-id="ee3a7-146">La convalida lato client richiede un valore per un campo modulo che corrisponde a una proprietà del modello che è stata contrassegnata `Required` e per una proprietà di tipo non nullable non sono stati contrassegnati `Required`.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-146">Client-side validation requires a value for a form field that corresponds to a model property that you've marked `Required` and for a non-nullable type property that you haven't marked `Required`.</span></span> <span data-ttu-id="ee3a7-147">`Required`può essere utilizzato per controllare il messaggio di errore di convalida lato client.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-147">`Required` can be used to control the client-side validation error message.</span></span>

## <a name="model-state"></a><span data-ttu-id="ee3a7-148">Stato del modello</span><span class="sxs-lookup"><span data-stu-id="ee3a7-148">Model State</span></span>

<span data-ttu-id="ee3a7-149">Stato del modello rappresenta gli errori di convalida nei valori di form HTML inviati.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-149">Model state represents validation errors in submitted HTML form values.</span></span>

<span data-ttu-id="ee3a7-150">MVC continuerà convalida dei campi finché non raggiunge il numero massimo di errori (200 per impostazione predefinita).</span><span class="sxs-lookup"><span data-stu-id="ee3a7-150">MVC will continue validating fields until reaches the maximum number of errors (200 by default).</span></span> <span data-ttu-id="ee3a7-151">È possibile configurare questo numero, inserendo il codice seguente nel `ConfigureServices` metodo il *Startup.cs* file:</span><span class="sxs-lookup"><span data-stu-id="ee3a7-151">You can configure this number by inserting the following code into the `ConfigureServices` method in the *Startup.cs* file:</span></span>

[!code-csharp[Main](validation/sample/Startup.cs?range=27)]

## <a name="handling-model-state-errors"></a><span data-ttu-id="ee3a7-152">Lo stato del modello di gestione degli errori</span><span class="sxs-lookup"><span data-stu-id="ee3a7-152">Handling Model State Errors</span></span>

<span data-ttu-id="ee3a7-153">Si verifica la convalida del modello prima di ogni azione del controller richiamato ed è responsabilità del metodo di azione per controllare `ModelState.IsValid` e rispondere nel modo appropriato.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-153">Model validation occurs prior to each controller action being invoked, and it is the action method’s responsibility to inspect `ModelState.IsValid` and react appropriately.</span></span> <span data-ttu-id="ee3a7-154">In molti casi, la reazione appropriata è di restituire un tipo di risposta di errore, in teoria che riporta in dettaglio il motivo per cui non è riuscita la convalida del modello.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-154">In many cases, the appropriate reaction is to return some kind of error response, ideally detailing the reason why model validation failed.</span></span>

<span data-ttu-id="ee3a7-155">Alcune applicazioni è possibile scegliere di seguire una convenzione standard per la gestione di errori di convalida del modello, nel qual caso un filtro può essere un luogo adatto per implementare criteri di.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-155">Some apps will choose to follow a standard convention for dealing with model validation errors, in which case a filter may be an appropriate place to implement such a policy.</span></span> <span data-ttu-id="ee3a7-156">È consigliabile testare il comportamento delle azioni con gli stati di modello valido e non validi.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-156">You should test how your actions behave with valid and invalid model states.</span></span>

## <a name="manual-validation"></a><span data-ttu-id="ee3a7-157">Convalida manuale</span><span class="sxs-lookup"><span data-stu-id="ee3a7-157">Manual validation</span></span>

<span data-ttu-id="ee3a7-158">Una volta completata la convalida e l'associazione di modelli, si desidera ripetere le parti.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-158">After model binding and validation are complete, you may want to repeat parts of it.</span></span> <span data-ttu-id="ee3a7-159">Ad esempio, un utente sia stato immesso testo in un campo a cui è previsto un numero intero o potrebbe essere necessario calcolare un valore per proprietà di un modello.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-159">For example, a user may have entered text in a field expecting an integer, or you may need to compute a value for a model's property.</span></span>

<span data-ttu-id="ee3a7-160">Potrebbe essere necessario eseguire manualmente la convalida.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-160">You may need to run validation manually.</span></span> <span data-ttu-id="ee3a7-161">A tale scopo, chiamare il `TryValidateModel` (metodo), come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="ee3a7-161">To do so, call the `TryValidateModel` method, as shown here:</span></span>

[!code-csharp[Main](validation/sample/MoviesController.cs?range=52)]

## <a name="custom-validation"></a><span data-ttu-id="ee3a7-162">Convalida personalizzata</span><span class="sxs-lookup"><span data-stu-id="ee3a7-162">Custom validation</span></span>

<span data-ttu-id="ee3a7-163">Gli attributi di convalida di lavoro per la maggior parte delle esigenze di convalida.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-163">Validation attributes work for most validation needs.</span></span> <span data-ttu-id="ee3a7-164">Tuttavia, alcune regole di convalida sono specifici per l'azienda, come non si appena è necessaria la convalida di dati generici, ad esempio garantire un campo o la conformità a un intervallo di valori.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-164">However, some validation rules are specific to your business, as they're not just generic data validation such as ensuring a field is required or that it conforms to a range of values.</span></span> <span data-ttu-id="ee3a7-165">Per questi scenari, gli attributi di convalida personalizzata sono un'ottima soluzione.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-165">For these scenarios, custom validation attributes are a great solution.</span></span> <span data-ttu-id="ee3a7-166">La creazione di attributi di convalida personalizzata in MVC è semplice.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-166">Creating your own custom validation attributes in MVC is easy.</span></span> <span data-ttu-id="ee3a7-167">Solo ereditare il `ValidationAttribute`ed eseguire l'override di `IsValid` metodo.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-167">Just inherit from the `ValidationAttribute`, and override the `IsValid` method.</span></span> <span data-ttu-id="ee3a7-168">Il `IsValid` metodo accetta due parametri, il primo è un oggetto denominato *valore* e il secondo è un `ValidationContext` oggetto denominato *validationContext*.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-168">The `IsValid` method accepts two parameters, the first is an object named *value* and the second is a `ValidationContext` object named *validationContext*.</span></span> <span data-ttu-id="ee3a7-169">*Valore* fa riferimento al valore effettivo del campo che convalida il validator personalizzato.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-169">*Value* refers to the actual value from the field that your custom validator is validating.</span></span>

<span data-ttu-id="ee3a7-170">Nell'esempio seguente indica che gli utenti non possono impostare il genere una regola business *classico* per un filmato rilasciato dopo 1960.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-170">In the following sample, a business rule states that users may not set the genre to *Classic* for a movie released after 1960.</span></span> <span data-ttu-id="ee3a7-171">Il `[ClassicMovie]` attributo controlla per primo il genere e se è un classico, quindi controlla la data di rilascio per verificare che è successiva a quella 1960.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-171">The `[ClassicMovie]` attribute checks the genre first, and if it is a classic, then it checks the release date to see that it is later than 1960.</span></span> <span data-ttu-id="ee3a7-172">Se viene rilasciato dopo 1960, la convalida non riesce.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-172">If it is released after 1960, validation fails.</span></span> <span data-ttu-id="ee3a7-173">L'attributo accetta un parametro integer che rappresenta l'anno che è possibile utilizzare per convalidare i dati.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-173">The attribute accepts an integer parameter representing the year that you can use to validate data.</span></span> <span data-ttu-id="ee3a7-174">È possibile acquisire il valore del parametro nel costruttore dell'attributo, come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="ee3a7-174">You can capture the value of the parameter in the attribute's constructor, as shown here:</span></span>

[!code-csharp[Main](validation/sample/ClassicMovieAttribute.cs?range=9-28)]

<span data-ttu-id="ee3a7-175">Il `movie` variabile sopra rappresenta un `Movie` oggetto che contiene i dati per convalidare l'invio del modulo.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-175">The `movie` variable above represents a `Movie` object that contains the data from the form submission to validate.</span></span> <span data-ttu-id="ee3a7-176">In questo caso, il codice di convalida controlla la data e un paese di `IsValid` metodo il `ClassicMovieAttribute` classe in base alle regole.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-176">In this case, the validation code checks the date and genre in the `IsValid` method of the `ClassicMovieAttribute` class as per the rules.</span></span> <span data-ttu-id="ee3a7-177">Dopo la convalida `IsValid` restituisce un `ValidationResult.Success` codice, e quando la convalida non riesce, un `ValidationResult` con un messaggio di errore.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-177">Upon successful validation `IsValid` returns a `ValidationResult.Success` code, and when validation fails, a `ValidationResult` with an error message.</span></span> <span data-ttu-id="ee3a7-178">Quando un utente modifica il `Genre` campo e invia il form, il `IsValid` metodo il `ClassicMovieAttribute` verificherà se il film sia un classico.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-178">When a user modifies the `Genre` field and submits the form, the `IsValid` method of the `ClassicMovieAttribute` will verify whether the movie is a classic.</span></span> <span data-ttu-id="ee3a7-179">Ad esempio un attributo predefinito, applicare il `ClassicMovieAttribute` a una proprietà, ad esempio `ReleaseDate` per garantire che convalida viene eseguita, come illustrato nell'esempio di codice precedente.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-179">Like any built-in attribute, apply the `ClassicMovieAttribute` to a property such as `ReleaseDate` to ensure validation happens, as shown in the previous code sample.</span></span> <span data-ttu-id="ee3a7-180">Poiché l'esempio funziona solo con `Movie` tipi, un'opzione migliore consiste nell'utilizzare `IValidatableObject` come illustrato nel paragrafo seguente.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-180">Since the example works only with `Movie` types, a better option is to use `IValidatableObject` as shown in the following paragraph.</span></span>

<span data-ttu-id="ee3a7-181">In alternativa, questo codice stesso può essere inserito nel modello mediante l'implementazione di `Validate` metodo il `IValidatableObject` interfaccia.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-181">Alternatively, this same code could be placed in the model by implementing the `Validate` method on the `IValidatableObject` interface.</span></span> <span data-ttu-id="ee3a7-182">Mentre gli attributi di convalida personalizzata funziona anche per la convalida delle proprietà singole, implementazione `IValidatableObject` può essere utilizzato per implementare la convalida a livello di classe come illustrato di seguito.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-182">While custom validation attributes work well for validating individual properties, implementing `IValidatableObject` can be used to implement class-level validation as seen here.</span></span>

[!code-csharp[Main](validation/sample/MovieIValidatable.cs?range=33-41)]

## <a name="client-side-validation"></a><span data-ttu-id="ee3a7-183">Convalida lato client</span><span class="sxs-lookup"><span data-stu-id="ee3a7-183">Client side validation</span></span>

<span data-ttu-id="ee3a7-184">La convalida lato client è una maggiore praticità per gli utenti.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-184">Client side validation is a great convenience for users.</span></span> <span data-ttu-id="ee3a7-185">Consente di risparmiare tempo in caso contrario spendere in attesa di un round trip al server.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-185">It saves time they would otherwise spend waiting for a round trip to the server.</span></span> <span data-ttu-id="ee3a7-186">In termini di business, anche alcuni le frazioni di secondo moltiplicato centinaia di volte al giorno consente di aggiungere fino a una quantità elevata di tempo, expense e frustrazione.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-186">In business terms, even a few fractions of seconds multiplied hundreds of times each day adds up to be a lot of time, expense, and frustration.</span></span> <span data-ttu-id="ee3a7-187">Convalida semplice e immediata consente agli utenti di lavorare in modo più efficiente e ottenere una migliore qualità di input e output.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-187">Straightforward and immediate validation enables users to work more efficiently and produce better quality input and output.</span></span>

<span data-ttu-id="ee3a7-188">È necessario disporre una vista con i riferimenti a script JavaScript appropriate sul posto per la convalida lato client funzionare come seguito.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-188">You must have a view with the proper JavaScript script references in place for client side validation to work as you see here.</span></span>

[!code-cshtml[Main](validation/sample/Views/Shared/_Layout.cshtml?range=37)]

[!code-cshtml[Main](validation/sample/Views/Shared/_ValidationScriptsPartial.cshtml)]

<span data-ttu-id="ee3a7-189">Per convalidare i dati e visualizzare eventuali messaggi di errore utilizzando JavaScript, MVC Usa attributi di convalida oltre ai metadati del tipo di proprietà del modello.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-189">MVC uses validation attributes in addition to type metadata from model properties to validate data and display any error messages using JavaScript.</span></span> <span data-ttu-id="ee3a7-190">Quando si utilizza MVC per il rendering degli elementi di formato da un modello utilizzando [gli helper di Tag](xref:mvc/views/tag-helpers/intro) o [helper HTML](xref:mvc/views/overview) verranno aggiunti HTML 5 [attributi dati](http://w3c.github.io/html/dom.html#embedding-custom-non-visible-data-with-the-data-attributes) negli elementi del form che devono essere convalidate, come di seguito riportato.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-190">When you use MVC to render form elements from a model using [Tag Helpers](xref:mvc/views/tag-helpers/intro) or [HTML helpers](xref:mvc/views/overview) it will add HTML 5 [data- attributes](http://w3c.github.io/html/dom.html#embedding-custom-non-visible-data-with-the-data-attributes) in the form elements that need validation, as shown below.</span></span> <span data-ttu-id="ee3a7-191">MVC genera il `data-` gli attributi per gli attributi incorporati e personalizzati.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-191">MVC generates the `data-` attributes for both built-in and custom attributes.</span></span> <span data-ttu-id="ee3a7-192">È possibile visualizzare gli errori di convalida sul client utilizzando gli helper di tag rilevanti, come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="ee3a7-192">You can display validation errors on the client using the relevant tag helpers as shown here:</span></span>

[!code-cshtml[Main](validation/sample/Views/Movies/Create.cshtml?highlight=4,5&range=19-25)]

<span data-ttu-id="ee3a7-193">Gli helper di tag precedenti in formato HTML riportato di seguito.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-193">The tag helpers above render the HTML below.</span></span> <span data-ttu-id="ee3a7-194">Si noti che il `data-` attributi nel codice HTML di output corrispondono agli attributi di convalida per il `ReleaseDate` proprietà.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-194">Notice that the `data-` attributes in the HTML output correspond to the validation attributes for the `ReleaseDate` property.</span></span> <span data-ttu-id="ee3a7-195">Il `data-val-required` attributo seguente contiene un messaggio di errore da visualizzare se l'utente non compila il campo Data di rilascio e consente di visualizzare che il messaggio di accompagnamento  **\<span >** elemento.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-195">The `data-val-required` attribute below contains an error message to display if the user doesn't fill in the release date field, and that message displays in the accompanying **\<span>** element.</span></span>

```html
<form action="/Movies/Create" method="post">
    <div class="form-horizontal">
        <h4>Movie</h4>
        <div class="text-danger"></div>
        <div class="form-group">
            <label class="col-md-2 control-label" for="ReleaseDate">ReleaseDate</label>
            <div class="col-md-10">
                <input class="form-control" type="datetime"
                data-val="true" data-val-required="The ReleaseDate field is required."
                id="ReleaseDate" name="ReleaseDate" value="" />
                <span class="text-danger field-validation-valid"
                data-valmsg-for="ReleaseDate" data-valmsg-replace="true"></span>
            </div>
        </div>
    </div>
</form>
```

<span data-ttu-id="ee3a7-196">La convalida lato client impedisce l'invio fino a quando il form è valido.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-196">Client-side validation prevents submission until the form is valid.</span></span> <span data-ttu-id="ee3a7-197">Pulsante Invia esegue JavaScript che invia il form o Visualizza messaggi di errore.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-197">The Submit button runs JavaScript that either submits the form or displays error messages.</span></span>

<span data-ttu-id="ee3a7-198">MVC determina i valori di attributo di tipo in base al tipo di dati .NET di una proprietà, probabilmente sottoposto a override utilizzando `[DataType]` attributi.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-198">MVC determines type attribute values based on the .NET data type of a property, possibly overridden using `[DataType]` attributes.</span></span> <span data-ttu-id="ee3a7-199">La base `[DataType]` attributo non esegue alcuna convalida reale lato server.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-199">The base `[DataType]` attribute does no real server-side validation.</span></span> <span data-ttu-id="ee3a7-200">Browser scegliere i propri messaggi di errore e visualizzare gli errori, ma vogliono, tuttavia il pacchetto non intrusivo convalida jQuery è possibile ignorare i messaggi e visualizzarli in modo coerente con altri utenti.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-200">Browsers choose their own error messages and display those errors however they wish, however the jQuery Validation Unobtrusive package can override the messages and display them consistently with others.</span></span> <span data-ttu-id="ee3a7-201">Questo errore si verifica più ovviamente quando gli utenti applicare `[DataType]` sottoclassi, ad esempio `[EmailAddress]`.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-201">This happens most obviously when users apply `[DataType]` subclasses such as `[EmailAddress]`.</span></span>

## <a name="iclientmodelvalidator"></a><span data-ttu-id="ee3a7-202">IClientModelValidator</span><span class="sxs-lookup"><span data-stu-id="ee3a7-202">IClientModelValidator</span></span>

<span data-ttu-id="ee3a7-203">È possibile creare logica sul lato client per l'attributo personalizzato, e [convalida non intrusiva](http://jqueryvalidation.org/documentation/) verrà eseguito sul client per l'utente automaticamente come parte della convalida.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-203">You may create client side logic for your custom attribute, and [unobtrusive validation](http://jqueryvalidation.org/documentation/) will execute it on the client for you automatically as part of validation.</span></span> <span data-ttu-id="ee3a7-204">Il primo passaggio consiste nel controllare gli attributi di dati vengono aggiunti mediante l'implementazione di `IClientModelValidator` interfaccia come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="ee3a7-204">The first step is to control what data- attributes are added by implementing the `IClientModelValidator` interface as shown here:</span></span>

[!code-csharp[Main](validation/sample/ClassicMovieAttribute.cs?range=30-42)]

<span data-ttu-id="ee3a7-205">Gli attributi che implementano questa interfaccia è possono aggiungere campi generati di attributi HTML.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-205">Attributes that implement this interface can add HTML attributes to generated fields.</span></span> <span data-ttu-id="ee3a7-206">Esaminare l'output per il `ReleaseDate` elemento rivela HTML che è simile all'esempio precedente, ma ora è un `data-val-classicmovie` attributo definita in precedenza il `AddValidation` metodo `IClientModelValidator`.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-206">Examining the output for the `ReleaseDate` element reveals HTML that is similar to the previous example, except now there is a `data-val-classicmovie` attribute that was defined in the `AddValidation` method of `IClientModelValidator`.</span></span>

```html
<input class="form-control" type="datetime"
    data-val="true"
    data-val-classicmovie="Classic movies must have a release year earlier than 1960."
    data-val-classicmovie-year="1960"
    data-val-required="The ReleaseDate field is required."
    id="ReleaseDate" name="ReleaseDate" value="" />
```

<span data-ttu-id="ee3a7-207">La convalida non intrusiva utilizza i dati di `data-` gli attributi da visualizzare i messaggi di errore.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-207">Unobtrusive validation uses the data in the `data-` attributes to display error messages.</span></span> <span data-ttu-id="ee3a7-208">Tuttavia, jQuery non riconosce le regole di messaggi o finché non vengono aggiunti del jQuery `validator` oggetto.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-208">However, jQuery doesn't know about rules or messages until you add them to jQuery's `validator` object.</span></span> <span data-ttu-id="ee3a7-209">Come illustrato nell'esempio riportato di seguito che aggiunge un metodo denominato `classicmovie` contenente codice di convalida personalizzata per il jQuery `validator` oggetto.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-209">This is shown in the example below that adds a method named `classicmovie` containing custom client validation code to the jQuery `validator` object.</span></span>

[!code-javascript[Main](validation/sample/Views/Movies/Create.cshtml?range=71-93)]

<span data-ttu-id="ee3a7-210">JQuery dispone ora le informazioni per eseguire la convalida personalizzata di JavaScript, nonché il messaggio di errore da visualizzare se il codice di convalida restituisce false.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-210">Now jQuery has the information to execute the custom JavaScript validation as well as the error message to display if that validation code returns false.</span></span>

## <a name="remote-validation"></a><span data-ttu-id="ee3a7-211">Convalida remota</span><span class="sxs-lookup"><span data-stu-id="ee3a7-211">Remote validation</span></span>

<span data-ttu-id="ee3a7-212">La convalida remota è una caratteristica fondamentale da utilizzare quando è necessario convalidare i dati nel client rispetto ai dati nel server.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-212">Remote validation is a great feature to use when you need to validate data on the client against data on the server.</span></span> <span data-ttu-id="ee3a7-213">Ad esempio, l'app potrebbe essere necessario verificare se un nome utente o di posta elettronica è già in uso e deve eseguire la query una grande quantità di dati a tale scopo.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-213">For example, your app may need to verify whether an email or user name is already in use, and it must query a large amount of data to do so.</span></span> <span data-ttu-id="ee3a7-214">Download di grandi set di dati per la convalida di uno o alcuni campi utilizza troppe risorse.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-214">Downloading large sets of data for validating one or a few fields consumes too many resources.</span></span> <span data-ttu-id="ee3a7-215">Può anche esporre informazioni riservate.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-215">It may also expose sensitive information.</span></span> <span data-ttu-id="ee3a7-216">In alternativa è possibile effettuare una richiesta di andata e ritorno per convalidare un campo.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-216">An alternative is to make a round-trip request to validate a field.</span></span>

<span data-ttu-id="ee3a7-217">È possibile implementare la convalida remota in un processo in due fasi.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-217">You can implement remote validation in a two step process.</span></span> <span data-ttu-id="ee3a7-218">In primo luogo, è necessario annotare il modello con il `[Remote]` attributo.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-218">First, you must annotate your model with the `[Remote]` attribute.</span></span> <span data-ttu-id="ee3a7-219">Il `[Remote]` attributo accetta più overload, è possibile utilizzare per indirizzare JavaScript sul lato client per il codice appropriato da chiamare.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-219">The `[Remote]` attribute accepts multiple overloads you can use to direct client side JavaScript to the appropriate code to call.</span></span> <span data-ttu-id="ee3a7-220">Nell'esempio punta al `VerifyEmail` il metodo di azione del `Users` controller.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-220">The example points to the `VerifyEmail` action method of the `Users` controller.</span></span>

[!code-csharp[Main](validation/sample/User.cs?range=5-9)]

<span data-ttu-id="ee3a7-221">Il secondo passaggio è l'inserimento di codice di convalida nel metodo di azione corrispondente come definito nel `[Remote]` attributo.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-221">The second step is putting the validation code in the corresponding action method as defined in the `[Remote]` attribute.</span></span> <span data-ttu-id="ee3a7-222">Restituisce un `JsonResult` che sul lato client consente di continuare o sospendere e visualizzare un errore, se necessario.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-222">It returns a `JsonResult` that the client side can use to proceed or pause and display an error if needed.</span></span>

[!code-none[Main](validation/sample/UsersController.cs?range=19-28)]

<span data-ttu-id="ee3a7-223">Ora quando gli utenti immettono un messaggio di posta elettronica, JavaScript nella visualizzazione effettua una chiamata remota per vedere se è stato eseguito il messaggio di posta elettronica e in tal caso, viene visualizzato il messaggio di errore.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-223">Now when users enter an email, JavaScript in the view makes a remote call to see if that email has been taken, and if so, then displays the error message.</span></span> <span data-ttu-id="ee3a7-224">In caso contrario, l'utente può inviare il modulo come di consueto.</span><span class="sxs-lookup"><span data-stu-id="ee3a7-224">Otherwise, the user can submit the form as usual.</span></span>
