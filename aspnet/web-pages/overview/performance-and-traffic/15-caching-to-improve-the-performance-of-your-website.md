---
uid: web-pages/overview/performance-and-traffic/15-caching-to-improve-the-performance-of-your-website
title: La memorizzazione nella cache di dati in un Web ASP.NET di pagine del sito (Razor) per ottenere prestazioni migliori | Documenti Microsoft
author: tfitzmac
description: "È possibile velocizzare il sito Web richiedendo store - ovvero cache: i risultati dei dati che in genere richiederebbe molto tempo per recuperare o elaborare un..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/14/2014
ms.topic: article
ms.assetid: 961e525b-7700-469e-8a68-d7010b6fb68c
ms.technology: dotnet-webpages
ms.prod: .net-framework
msc.legacyurl: /web-pages/overview/performance-and-traffic/15-caching-to-improve-the-performance-of-your-website
msc.type: authoredcontent
ms.openlocfilehash: c747fef33a6d1db19f09fd0303c47d689b956687
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/10/2017
---
<a name="caching-data-in-an-aspnet-web-pages-razor-site-for-better-performance"></a><span data-ttu-id="0bb5d-103">Memorizzazione nella cache i dati nel sito Web ASP.NET (Razor) pagine per migliorare le prestazioni</span><span class="sxs-lookup"><span data-stu-id="0bb5d-103">Caching Data in an ASP.NET Web Pages (Razor) Site for Better Performance</span></span>
====================
<span data-ttu-id="0bb5d-104">da [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="0bb5d-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="0bb5d-105">In questo articolo viene illustrato come utilizzare un metodo di supporto per informazioni sulla cache per migliorare le prestazioni in un sito Web ASP.NET Web Pages (Razor).</span><span class="sxs-lookup"><span data-stu-id="0bb5d-105">This article explains how to use a helper to cache information for faster performance in an ASP.NET Web Pages (Razor) website.</span></span> <span data-ttu-id="0bb5d-106">È possibile velocizzare il sito Web facendo sì che store &#8212; vale a dire cache &#8212; i risultati dei dati che in genere richiederebbe molto tempo per recuperare o l'elaborazione e che non vengono modificati spesso.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-106">You can speed up your website by having it store &#8212; that is, cache &#8212; the results of data that ordinarily would take considerable time to retrieve or process and that does not change often.</span></span>
> 
> <span data-ttu-id="0bb5d-107">**Illustra quanto segue:**</span><span class="sxs-lookup"><span data-stu-id="0bb5d-107">**What you'll learn:**</span></span> 
> 
> - <span data-ttu-id="0bb5d-108">Come utilizzare la memorizzazione nella cache per migliorare la velocità di risposta del sito Web.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-108">How to use caching to improve the responsiveness of your website.</span></span>
> 
> <span data-ttu-id="0bb5d-109">Queste sono le funzionalità ASP.NET introdotte nell'articolo:</span><span class="sxs-lookup"><span data-stu-id="0bb5d-109">These are the ASP.NET features introduced in the article:</span></span>
> 
> - <span data-ttu-id="0bb5d-110">Il `WebCache` helper.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-110">The `WebCache` helper.</span></span>
>   
> 
> ## <a name="software-versions-used-in-the-tutorial"></a><span data-ttu-id="0bb5d-111">Versioni del software utilizzate nell'esercitazione</span><span class="sxs-lookup"><span data-stu-id="0bb5d-111">Software versions used in the tutorial</span></span>
> 
> 
> - <span data-ttu-id="0bb5d-112">Pagine Web ASP.NET (Razor) 3</span><span class="sxs-lookup"><span data-stu-id="0bb5d-112">ASP.NET Web Pages (Razor) 3</span></span>
>   
> 
> <span data-ttu-id="0bb5d-113">In questa esercitazione si integra inoltre con ASP.NET Web Pages 2.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-113">This tutorial also works with ASP.NET Web Pages 2.</span></span>


<span data-ttu-id="0bb5d-114">Ogni volta che un utente richiede una pagina del sito, il server web deve eseguire alcune operazioni per soddisfare la richiesta.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-114">Every time someone requests a page from your site, the web server has to do some work in order to fulfill the request.</span></span> <span data-ttu-id="0bb5d-115">Per alcune delle pagine, il server potrebbe essere necessario eseguire le attività che accettano (relativamente) molto tempo, ad esempio il recupero dei dati da un database.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-115">For some of your pages, the server might have to perform tasks that take a (comparatively) long time, such as retrieving data from a database.</span></span> <span data-ttu-id="0bb5d-116">Anche se queste attività traggono tempo in termini assoluti, se il sito di cui si verifichi un traffico elevato, può aggiungere un'intera serie di singole richieste che causano il server web eseguire l'attività complessa o lento a una grande quantità di lavoro.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-116">Even if these tasks don't take long in absolute terms, if your site experiences a lot of traffic, a whole series of individual requests that cause the web server to perform the complicated or slow task can add up to a lot of work.</span></span> <span data-ttu-id="0bb5d-117">Infine, si possono influenzare le prestazioni del sito.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-117">This can ultimately affect the performance of the site.</span></span>

<span data-ttu-id="0bb5d-118">Un modo per migliorare le prestazioni del sito Web in casi come questo è per memorizzare i dati.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-118">One way to improve the performance of your website in circumstances like this is to cache data.</span></span> <span data-ttu-id="0bb5d-119">Se il sito Ottiene le richieste ripetute per le stesse informazioni e le informazioni non devono essere modificate per ogni persona e non è possibile ora sensibili, anziché recuperare nuovamente o il ricalcolo, è possibile recuperare i dati una volta e quindi archiviare i risultati.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-119">If your site gets repeated requests for the same information, and the information does not need to be modified for each person, and it's not time sensitive, instead of re-fetching or recalculating it, you can fetch the data once and then store the results.</span></span> <span data-ttu-id="0bb5d-120">La volta successiva che arriva una richiesta per tale informazioni, è sufficiente scaricare il pacchetto dalla cache.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-120">The next time a request comes in for that information, you just get it out of the cache.</span></span>

<span data-ttu-id="0bb5d-121">In generale, nella cache di informazioni che non cambiano frequentemente.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-121">In general, you cache information that doesn't change frequently.</span></span> <span data-ttu-id="0bb5d-122">Le informazioni inserite nella cache, archiviato in memoria nel server web.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-122">When you put information in the cache, it's stored in memory on the web server.</span></span> <span data-ttu-id="0bb5d-123">È possibile specificare il tempo che deve essere memorizzata nella cache, da secondi a giorni.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-123">You can specify how long it should be cached, from seconds to days.</span></span> <span data-ttu-id="0bb5d-124">Quando il periodo di memorizzazione nella cache scade, le informazioni vengono rimosse automaticamente dalla cache.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-124">When the caching period expires, the information is automatically removed from the cache.</span></span>

> [!NOTE]
> <span data-ttu-id="0bb5d-125">Le voci nella cache potrebbero essere rimossi per motivi diversi da sono scadute.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-125">Entries in the cache might be removed for reasons other than that they've expired.</span></span> <span data-ttu-id="0bb5d-126">Ad esempio, il server web potrebbe essere temporaneamente insufficiente per la memoria e può recuperare memoria, è possibile generare voci dalla cache.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-126">For example, the web server might temporarily run low on memory, and one way it can reclaim memory is by throwing entries out of the cache.</span></span> <span data-ttu-id="0bb5d-127">Come si vedrà, anche se è stata inserire informazioni nella cache, è necessario verificare che è ancora presente quando necessario.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-127">As you'll see, even if you've put information into the cache, you have to check to be sure it's still there when you need it.</span></span>


<span data-ttu-id="0bb5d-128">Si supponga che il sito Web disponga di una pagina che consente di visualizzare la temperatura corrente e previsioni del tempo.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-128">Imagine your website has a page that displays the current temperature and weather forecast.</span></span> <span data-ttu-id="0bb5d-129">Per ottenere questo tipo di informazioni, è possibile inviare una richiesta a un servizio esterno.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-129">To get this type of information, you might send a request to an external service.</span></span> <span data-ttu-id="0bb5d-130">Poiché queste informazioni non viene modificato molto (all'interno di un periodo di tempo di due ore, ad esempio) e dal momento che le chiamate esterne richiedono tempo e larghezza di banda, è un buon candidato per la memorizzazione nella cache.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-130">Since this information doesn't change much (within a two-hour time period, for example) and since external calls require time and bandwidth, it's a good candidate for caching.</span></span>

## <a name="adding-caching-to-a-page"></a><span data-ttu-id="0bb5d-131">Aggiunta a una pagina di memorizzazione nella cache</span><span class="sxs-lookup"><span data-stu-id="0bb5d-131">Adding Caching to a Page</span></span>

<span data-ttu-id="0bb5d-132">ASP.NET include un `WebCache` helper che rende più semplice aggiungere la memorizzazione nella cache per il sito e aggiungere dati alla cache.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-132">ASP.NET includes a `WebCache` helper that makes it easy to add caching to your site and add data to the cache.</span></span> <span data-ttu-id="0bb5d-133">In questa procedura, si creerà una pagina che memorizza nella cache l'ora corrente.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-133">In this procedure, you'll create a page that caches the current time.</span></span> <span data-ttu-id="0bb5d-134">Questo non è un esempio reale, poiché l'ora corrente è un elemento che cambiano spesso e che inoltre non è difficile da calcolare.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-134">This isn't a real-world example, since the current time is something that does change often, and that moreover isn't complex to calculate.</span></span> <span data-ttu-id="0bb5d-135">Tuttavia, è un buon metodo per illustrare la memorizzazione nella cache in azione.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-135">However, it's a good way to illustrate caching in action.</span></span>

1. <span data-ttu-id="0bb5d-136">Aggiungere una nuova pagina denominata *WebCache.cshtml* al sito Web.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-136">Add a new page named *WebCache.cshtml* to the website.</span></span>
2. <span data-ttu-id="0bb5d-137">Aggiungere il seguente codice e markup alla pagina:</span><span class="sxs-lookup"><span data-stu-id="0bb5d-137">Add the following code and markup to the page:</span></span>

    [!code-cshtml[Main](15-caching-to-improve-the-performance-of-your-website/samples/sample1.cshtml)]

    <span data-ttu-id="0bb5d-138">Quando si memorizza nella cache di dati, si inserisce nella cache usando un nome di questo è univoco tra il sito Web.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-138">When you cache data, you put it into the cache using a name this is unique across the website.</span></span> <span data-ttu-id="0bb5d-139">In questo caso, si userà una voce della cache denominata `CachedTime`.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-139">In this case, you'll use a cache entry named `CachedTime`.</span></span> <span data-ttu-id="0bb5d-140">Si tratta di `cacheItemKey` illustrato nell'esempio di codice.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-140">This is the `cacheItemKey` shown in the code example.</span></span>

    <span data-ttu-id="0bb5d-141">Il codice legge innanzitutto la `CachedTime` della voce della cache.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-141">The code first reads the `CachedTime` cache entry.</span></span> <span data-ttu-id="0bb5d-142">Se viene restituito un valore (ovvero, se la voce della cache non è null), il codice imposta solo il valore della variabile di tempo per i dati della cache.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-142">If a value is returned (that is, if the cache entry isn't null), the code just sets the value of the time variable to the cache data.</span></span>

    <span data-ttu-id="0bb5d-143">Tuttavia, se la voce della cache non esiste (vale a dire è null), il codice imposta il valore di ora, viene aggiunto alla cache e imposta un valore di scadenza a un minuto.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-143">However, if the cache entry doesn't exist (that is, it's null), the code sets the time value, adds it to the cache, and sets an expiration value to one minute.</span></span> <span data-ttu-id="0bb5d-144">Dopo un minuto, verrà eliminata la voce della cache.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-144">After one minute, the cache entry is discarded.</span></span> <span data-ttu-id="0bb5d-145">(Il valore di scadenza predefinita per un elemento nella cache è 20 minuti). Il comando `WebCache.Set(cacheItemKey, time, 1, false)` viene illustrato come aggiungere il valore di tempo corrente nella cache e impostare la scadenza su 1 minuto.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-145">(The default expiration value for an item in the cache is 20 minutes.) The command `WebCache.Set(cacheItemKey, time, 1, false)` shows how to add the current time value to the cache and set its expiration to 1 minute.</span></span> <span data-ttu-id="0bb5d-146">L'impostazione di *slidingExpiration* parametro `false` indica l'ora di scadenza non viene rinnovato ogni volta che viene richiesto.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-146">Setting the *slidingExpiration* parameter to `false` means the expiration time is not renewed each time it is requested.</span></span> <span data-ttu-id="0bb5d-147">Scadenza esattamente 1 minuto dopo che è stati precedentemente aggiunti alla cache.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-147">It will expire exactly 1 minute after it was originally added to the cache.</span></span> <span data-ttu-id="0bb5d-148">Se si imposta questo valore su `true` l'ora di scadenza di 1 minuto viene reimpostato ogni volta che viene richiesto il valore dalla cache.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-148">If you set this value to `true` the 1 minute expiration time is reset each time the value is requested from the cache.</span></span>

    <span data-ttu-id="0bb5d-149">Questo codice illustra il modello che è consigliabile usare sempre quando si memorizza nella cache di dati.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-149">This code illustrates the pattern you should always use when you cache data.</span></span> <span data-ttu-id="0bb5d-150">Prima di ottenere un elemento dalla cache, sempre controllare innanzitutto se il `WebCache.Get` metodo ha restituito null.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-150">Before you get something out of the cache, always check first whether the `WebCache.Get` method has returned null.</span></span> <span data-ttu-id="0bb5d-151">Tenere presente che la voce della cache potrebbe essere scaduti o che potrebbe essere stato rimosso per altri motivi, pertanto qualsiasi voce specificata non è nella cache.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-151">Remember that the cache entry might have expired or might have been removed for some other reason, so any given entry is never guaranteed to be in the cache.</span></span>
3. <span data-ttu-id="0bb5d-152">Eseguire *WebCache.cshtml* in un browser.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-152">Run *WebCache.cshtml* in a browser.</span></span> <span data-ttu-id="0bb5d-153">(Assicurarsi che la pagina è selezionata nel **file** dell'area di lavoro prima di eseguirlo.) La prima volta che la richiesta di pagina, i dati di ora non sono nella cache e il codice deve aggiungere il valore di ora alla cache.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-153">(Make sure the page is selected in the **Files** workspace before you run it.) The first time you request the page, the time data isn't in the cache, and the code has to add the time value to the cache.</span></span>

    ![cache-1](15-caching-to-improve-the-performance-of-your-website/_static/image1.jpg)
4. <span data-ttu-id="0bb5d-155">Aggiorna *WebCache.cshtml* nel browser.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-155">Refresh *WebCache.cshtml* in the browser.</span></span> <span data-ttu-id="0bb5d-156">Questa volta, i dati di ora sono nella cache.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-156">This time, the time data is in the cache.</span></span> <span data-ttu-id="0bb5d-157">Si noti che l'ora non è stato modificato dall'ultima volta che si visualizza la pagina.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-157">Notice that the time hasn't changed since the last time you viewed the page.</span></span>

    ![cache-2](15-caching-to-improve-the-performance-of-your-website/_static/image2.jpg)
5. <span data-ttu-id="0bb5d-159">Attendere un minuto per svuotare la cache e quindi aggiornare la pagina.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-159">Wait one minute for the cache to be emptied, and then refresh the page.</span></span> <span data-ttu-id="0bb5d-160">La pagina nuovo indica che i dati di ora non è stati trovati nella cache e l'ora dell'aggiornamento viene aggiunto alla cache.</span><span class="sxs-lookup"><span data-stu-id="0bb5d-160">The page again indicates that the time data wasn't found in the cache, and the updated time is added to the cache.</span></span>

<a id="Additional_Resources"></a>
## <a name="additional-resources"></a><span data-ttu-id="0bb5d-161">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="0bb5d-161">Additional Resources</span></span>


- [<span data-ttu-id="0bb5d-162">La visualizzazione dei dati in un grafico</span><span class="sxs-lookup"><span data-stu-id="0bb5d-162">Displaying Data in a Chart</span></span>](https://go.microsoft.com/fwlink/?LinkId=202895)
- <span data-ttu-id="0bb5d-163">[Riferimento all'API WebCache](https://msdn.microsoft.com/en-us/library/system.web.helpers.webcache(v=vs.99).aspx) (MSDN)</span><span class="sxs-lookup"><span data-stu-id="0bb5d-163">[WebCache API reference](https://msdn.microsoft.com/en-us/library/system.web.helpers.webcache(v=vs.99).aspx) (MSDN)</span></span>
